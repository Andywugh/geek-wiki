<!DOCTYPE html><html data-bs-theme="light" itemscope="" itemtype="http://schema.org/WebPage" lang="zh-hans"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="manifest" href="https://www.hotmindshare.com/manifest.webmanifest"/><link rel="alternate" type="application/rss+xml" href="https://www.hotmindshare.com/archives/2023/10/index.xml"/><meta name="description" content="十月"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_16x16_resize_box_3.png" sizes="16x16" type="image/png"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_32x32_resize_box_3.png" sizes="32x32" type="image/png"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_150x150_resize_box_3.png" sizes="150x150" type="image/png"/><link rel="apple-touch-icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_180x180_resize_box_3.png" sizes="180x180" type="image/png"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_192x192_resize_box_3.png" sizes="192x192" type="image/png"/><link rel="mask-icon" href="/mask-icon.svg" color="#000000"/><meta property="og:title" content="十月"/><meta property="og:description" content="一个只爱折腾技术的普通人"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.hotmindshare.com/archives/2023/10/"/><meta itemprop="name" content="十月"/><meta itemprop="description" content="一个只爱折腾技术的普通人"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="十月"/><meta name="twitter:description" content="一个只爱折腾技术的普通人"/><title>十月 - 3/34 - 2023 - 归档 - 程序员安仔</title>
<link href="/css/hb.ba6a98e9153069fb703ede031b9a2ce2efaed55ccf52f45dfe518c0c22acfd72.css" rel="stylesheet"/><script src="/js/init.577d4e90bff5601d5756fcf799b0e53568bf56cea3b80fe43f66c9d365e8100c.js" integrity="sha256-V31OkL/1YB1XVvz3mbDlNWi/Vs6juA/kP2bJ02XoEAw="></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?1cbf85f7bc76266af7bdac71374879bf",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel="stylesheet" href="/css/search.ee67fb063f2e4be8eff1be9d9806279c3c3d43570b6266c759281faac3804b11.css"/></head><body><noscript><div class="alert alert-danger text-center rounded-0" role=alert><svg aria-hidden="true" class="bi bi-exclamation-square-fillbi bi-exclamation-square-fill hi-svg-inline me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm6 4c.535.0.954.462.9.995l-.35 3.507a.552.552.0 01-1.1.0L7.1 4.995A.905.905.0 018 4m.002 6a1 1 0 110 2 1 1 0 010-2"/></svg>你的浏览器不支持 JavaScript。</div></noscript><header class="hb-header"><nav class="hb-header-nav navbar navbar-expand-lg"><div class="container-fluid"><a class="navbar-brand d-flex align-items-center" href="/"><img src="https://www.hotmindshare.com/images/logo_hu3f5eb531558986e612421c7146e04118_941594_0x64_resize_box_3.png" alt="Logo" width="64" height="64" class="hb-header-logo d-inline-block align-text-top me-2"/>程序员安仔</a><div class="d-flex order-5"><div class="search-modal-toggle hb-header-search-form position-relative d-flex ms-lg-1"><button type="button" class="hb-header-search-icon border-0 bg-transparent px-2" aria-label="Toggle search">
<svg aria-hidden="true" class="bi bi-searchbi bi-search hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1.007 1.007.0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"></path></svg></button>
<input class="form-control rounded-5 d-none d-lg-block ms-lg-1" id="hb-header-search-input" placeholder="搜索"/>
<span class="hb-header-search-keys position-absolute d-none d-lg-block"><kbd>CTRL</kbd>
<kbd>K</kbd></span></div><button class="navbar-toggler border-0 shadow-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#hb-header-content" aria-controls="hb-header-content" aria-label="Toggle navigation"><svg aria-hidden="true" class="bi bi-three-dotsbi bi-three-dots hi-svg-inline" fill="currentcolor" height="1.25em" viewBox="0 0 16 16" width="1.25em" xmlns="http://www.w3.org/2000/svg"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3"></path></svg></button></div><div class="offcanvas offcanvas-lg offcanvas-end" tabindex="-1" id="hb-header-content" aria-labelledby="hb-header-content-label"><div class="offcanvas-header"><h5 class="offcanvas-title" id="hb-header-content-label">程序员安仔</h5><button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button></div><div class="offcanvas-body"><ul class="hb-header-menus navbar-nav flex-row flex-wrap"><li class="hb-header-menu nav-item col-6 col-lg-auto"><a class="nav-link" href="https://www.hotmindshare.com/docs/"><svg aria-hidden="true" class="bi bi-bookbi bi-book hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5.0 000 2.5v11a.5.5.0 00.707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5.0 00.78.0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5.0 0016 13.5v-11a.5.5.0 00-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"></path></svg>技术教程</a></li><li class="hb-header-menu dropdown nav-item col-12 col-lg-auto active"><a class="nav-link pe-0 d-inline-flex align-items-center active" href="/blog/" aria-current="page"><svg aria-hidden="true" class="hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M192 32c0 17.7 14.3 32 32 32 123.7.0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1.0 224 0c-17.7.0-32 14.3-32 32zm0 96c0 17.7 14.3 32 32 32 70.7.0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7.0-32 14.3-32 32zM96 144c0-26.5-21.5-48-48-48S0 117.5.0 144V368c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144H128v96h16c26.5.0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48V144z"></path></svg>博客</a>
<a class="nav-link ps-0 d-inline-flex" href="#" id="header-menu-blog" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span class="visually-hidden">Toggle Dropdown</span><svg aria-hidden="true" class="bi bi-chevron-compact-downbi bi-chevron-compact-down hi-svg-inline" fill="currentcolor" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1.553 6.776a.5.5.0 01.67-.223L8 9.44l5.776-2.888a.5.5.0 11.448.894l-6 3a.5.5.0 01-.448.0l-6-3a.5.5.0 01-.223-.67z"></path></svg></a><ul class="hb-header-submenus dropdown-menu" aria-labelledby="header-menu-blog" data-bs-popper="none"><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/series/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-columnsbi bi-columns hi-svg-inline" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2a1 1 0 011-1h14a1 1 0 011 1v12a1 1 0 01-1 1H1a1 1 0 01-1-1zm8.5.0v8H15V2zm0 9v3H15v-3zm-1-9H1v3h6.5zM1 14h6.5V6H1z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">专栏</div><p class="dropdown-item-desc mb-0 text-wrap">所有专栏。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/authors/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-pencilbi bi-pencil hi-svg-inline" fill="currentcolor" height="2em" style="color:#0f5e97" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M12.146.146a.5.5.0 01.708.0l3 3a.5.5.0 010 .708l-10 10a.5.5.0 01-.168.11l-5 2a.5.5.0 01-.65-.65l2-5a.5.5.0 01.11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5.0 01.5.5v.5h.5a.5.5.0 01.5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5.0 015 12.5V12h-.5a.5.5.0 01-.5-.5V11h-.5a.5.5.0 01-.468-.325z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">作者</div><p class="dropdown-item-desc mb-0 text-wrap">作者列表。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/categories/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-folderbi bi-folder hi-svg-inline" fill="currentcolor" height="2em" style="color:orange" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M.54 3.87.5 3a2 2 0 012-2h3.672a2 2 0 011.414.586l.828.828A2 2 0 009.828 3h3.982a2 2 0 011.992 2.181l-.637 7A2 2 0 0113.174 14H2.826A2 2 0 01.835 12.181l-.637-7a1.99 1.99.0 01.342-1.31zM2.19 4a1 1 0 00-.996 1.09l.637 7a1 1 0 00.995.91h10.348a1 1 0 00.995-.91l.637-7A1 1 0 0013.81 4H2.19zm4.69-1.707A1 1 0 006.172 2H2.5a1 1 0 00-1 .981l.006.139C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">分类</div><p class="dropdown-item-desc mb-0 text-wrap">所有分类。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center active" href="https://www.hotmindshare.com/archives/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-archivebi bi-archive hi-svg-inline" fill="currentcolor" height="2em" style="color:384955" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1v7.5A2.5 2.5.0 0112.5 15h-9A2.5 2.5.0 011 12.5V5A1 1 0 010 4zm2 3v7.5A1.5 1.5.0 003.5 14h9a1.5 1.5.0 001.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5.0 01.5-.5h5a.5.5.0 010 1h-5A.5.5.0 015 7.5"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">归档</div><p class="dropdown-item-desc mb-0 text-wrap">文章归档。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/tags/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-tagsbi bi-tags hi-svg-inline" fill="currentcolor" height="2em" style="color:green" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M3 2v4.586l7 7L14.586 9l-7-7zM2 2a1 1 0 011-1h4.586a1 1 0 01.707.293l7 7a1 1 0 010 1.414l-4.586 4.586a1 1 0 01-1.414.0l-7-7A1 1 0 012 6.586z"></path><path d="M5.5 5a.5.5.0 110-1 .5.5.0 010 1m0 1a1.5 1.5.0 100-3 1.5 1.5.0 000 3M1 7.086a1 1 0 00.293.707L8.75 15.25l-.043.043a1 1 0 01-1.414.0l-7-7A1 1 0 010 7.586V3a1 1 0 011-1z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">标签</div><p class="dropdown-item-desc mb-0 text-wrap">所有标签。</p></div></a></li></ul></li></ul><ul class="hb-header-panel navbar-nav flex-row flex-wrap"><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><hr class="d-lg-none my-2 text-body-50"/></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="mailto:andywuwu0728@gmail.com" target="_blank" rel="nofollow me" title="Email"><svg aria-hidden="true" class="bi bi-envelope-fillbi bi-envelope-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"></path></svg><span class="hb-social-text d-lg-none ms-1">Email</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="https://github.com/Andywugh" target="_blank" rel="nofollow me" title="GitHub"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="hb-social-text d-lg-none ms-1">GitHub</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="/index.xml" target="_blank" rel="nofollow me" title="RSS"><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"></path></svg><span class="hb-social-text d-lg-none ms-1">RSS</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="https://www.zhihu.com/people/Andywuwu" target="_blank" rel="nofollow me" title="知乎"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Zhihu</title><path d="M5.721.0C2.251.0.0 2.25.0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75.0 18.281.0zm1.964 4.078c-.271.73-.5 1.434-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58.104 58.104.0 01-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.223 9.223.0 01-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125zM13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"></path></svg><span class="hb-social-text d-lg-none ms-1">知乎</span></a></li><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><div class="vr d-none d-lg-flex h-100 mx-lg-2 text-body"></div><hr class="d-lg-none my-2 text-body-50"/></li><li class="theme-toggle nav-item dropdown col-6 col-lg-auto d-flex flex-column justify-content-center"><button class="btn btn-link btn-theme-toggle nav-link py-2 px-0 px-lg-2 d-flex justify-content-start justify-content-lg-center align-items-center" data-style="switch" aria-expanded="false" title="主题">
<svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1 theme-toggle-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1zm0 1A8 8 0 118 0a8 8 0 010 16"></path></svg><span class="d-lg-none ms-1 theme-name">主题</span></button><ul class="theme-toggle-menu dropdown-menu dropdown-menu-end"><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name="自动" data-bs-theme-value="auto">
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1zm0 1A8 8 0 118 0a8 8 0 010 16"></path></svg></span>自动</button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name="暗色" data-bs-theme-value="dark">
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-moon-starsbi bi-moon-stars hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278M4.858 1.311A7.269 7.269.0 001.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316.0 005.205-2.162c-.337.042-.68.063-1.029.063-4.61.0-8.343-3.714-8.343-8.29.0-1.167.242-2.278.681-3.286z"></path><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></svg></span>暗色</button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name="亮色" data-bs-theme-value="light">
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-brightness-highbi bi-brightness-high hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 11a3 3 0 110-6 3 3 0 010 6m0 1a4 4 0 100-8 4 4 0 000 8M8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0m0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13m8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5M3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8m10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0m-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707M4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"></path></svg></span>亮色</button></li></ul></li></ul></div></div></div></nav></header><div class="hb-main container"><div class="container-fluid px-0 mb-4"><nav aria-label="breadcrumb"><ol class="hb-breadcrumb breadcrumb"><li class="breadcrumb-item"><a href="/" title="程序员安仔的技术文档/博客">主页</a></li><li class="breadcrumb-item"><a href="/archives/" title="归档">归档</a></li><li class="breadcrumb-item"><a href="/archives/2023/" title="2023">2023</a></li><li class="breadcrumb-item active" aria-current="page"><a href="/archives/2023/10/" title="十月">十月</a></li></ol></nav></div><div class="archives border-start border-5 ps-4 pt-3 position-relative"><div class="archive border-1"><div class="archive-heading h4 mb-4 border-bottom pb-3 border-2"><a class="text-decoration-none" href="/archives/2023/">2023</a></div><div class="archive-subheading h5 mb-3"><a class="text-decoration-none" href="/archives/2023/10/">十月</a></div><div class="archive-posts border-top pt-3"><div class="hb-blog-posts row row-cols-1 row-cols-lg-2 row-cols-xl-3 g-3 mb-3"><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/133/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百三十三、HBase使用备份集" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百三十三、HBase使用备份集" href="/docs/bigdata/hbase/133/">一百三十三、HBase使用备份集</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">使用备份集 备份集可以通过减少表名重复输入的数量来简化HBase数据备份和还原的管理。您可以使用该hbase backup set add命令将表分组到命名备份集中。然后，您可以使用-set选项在hbase backup create或hbase backup restore中调用备份集的名称，而不是单独列出组中的每个表。您可以拥有多个备份集。
请注意hbase backup set add命令和*-set*选项之间的区别：必须先运行该hbase backup set add命令，然后才能在其他命令中使用该-set选项，因为在将备份集用作快捷方式之前，必须先命名并定义备份集。
如果运行该hbase backup set add命令并指定系统上尚不存在的备份集名称，则会创建一个新集。如果使用现有备份集名称的名称的命令，则指定的表将添加到该集合中。
在此命令中，备份集名称区分大小写。
备份集的元数据存储在HBase中。如果您无法访问具有备份集元数据的原始HBase群集，则必须指定单个表名以还原数据。
要创建备份集，请以HBase超级用户身份运行以下命令：
1$ hbase backup set &lt;subcommand&gt; &lt;backup_set_name&gt; &lt;tables&gt; 备份集子命令 # 以下列表详细介绍了hbase backup set命令的子命令。
在hbase backup set设置完成操作后，必须输入以下子命令中的一个（且不超过一个）。此外，备份集名称在命令行实用程序中区分大小写。
add
将表[s]添加到备份集。在此参数后面指定backup_set_name值以创建备份集。
remove
从集中删除表。在tables参数中指定要删除的表。
list
列出所有备份集。
describe
显示备份集的描述。该信息包括该集是否具有完整备份或增量备份，备份的开始和结束时间以及集合中的表列表。此子命令必须位于backup_set_name值的有效值之前。
delete
删除备份集。在命令后直接输入backup_set_name选项的值hbase backup set delete。
位置命令行参数 # backup_set_name
用于分配或调用备份集名称。备份集名称必须仅包含可打印字符，并且不能包含任何空格。
tables
要包含在备份集中的表（或单个表）的列表。输入表名作为逗号分隔列表。如果未指定表，则所有表都包含在集中。
在单独或远程群集的备份策略中维护区分大小写的备份集名称的日志或其他记录以及每个集合中的相应表。此信息可以帮助您在主群集失败的情况下进行。
用法示例 1$ hbase backup set add Q1Data TEAM3,TEAM_4 根据不同的环境，在此命令导致一个以下操作：
如果Q1Data备份集不存在，则创建包含表TEAM_3和TEAM_4的备份集。 如果Q1Data备份集已经存在，表TEAM_3和TEAM_4添加到Q1Data备份集。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/137/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百三十七、HBase删除备份映像" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百三十七、HBase删除备份映像" href="/docs/bigdata/hbase/137/">一百三十七、HBase删除备份映像</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">删除备份映像 此命令可用于删除不再需要的备份映像。
1$ hbase backup delete &lt;backup_id&gt; 位置命令行参数 # backup_id
应该删除备份映像的ID。
命名命令行参数 # 没有。
用法示例 1$ hbase backup delete backupId_1467823988425</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/136/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百三十六、HBase描述备份映像" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百三十六、HBase描述备份映像" href="/docs/bigdata/hbase/136/">一百三十六、HBase描述备份映像</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">描述备份映像 此命令可用于获取有关特定备份映像的信息。
1$ hbase backup describe &lt;backup_id&gt; 位置命令行参数 # backup_id
要描述的备份映像的ID。
命名命令行参数 # 没有。
用法示例 1$ hbase backup describe backupId_1467823988425</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/139/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百三十九、HBase配置密钥" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百三十九、HBase配置密钥" href="/docs/bigdata/hbase/139/">一百三十九、HBase配置密钥</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">配置密钥 备份和还原功能包括必需的和可选的配置密钥。
必需的属性 hbase.backup.enable：控制是否启用该功能，默认值为false，将此值设置为true。
hbase.master.logcleaner.plugins：清除HBase Master中的日志时调用的逗号分隔的类列表。将此值设置为org.apache.hadoop.hbase.backup.master.BackupLogCleaner或将其附加到当前值。
hbase.procedure.master.classes：使用Master中的Procedure框架调用的逗号分隔的类列表。将此值设置为org.apache.hadoop.hbase.backup.master.LogRollMasterProcedureManager或将其附加到当前值。
hbase.procedure.regionserver.classes：使用RegionServer中的Procedure框架调用的逗号分隔的类列表。将此值设置为org.apache.hadoop.hbase.backup.regionserver.LogRollRegionServerProcedureManager或将其附加到当前值。
hbase.coprocessor.region.classes：在表上部署的以逗号分隔的RegionObservers列表。将此值设置为org.apache.hadoop.hbase.backup.BackupObserver或将其附加到当前值。
hbase.master.hfilecleaner.plugins：在Master上部署的以逗号分隔的HFileCleaners列表。将此值设置为org.apache.hadoop.hbase.backup.BackupHFileCleaner或将其附加到当前值。
可选属性 hbase.backup.system.ttl：hbase:backup表中数据的生存时间（默认值：forever）。此属性仅在创建hbase:backup表之前相关。当此表已存在时，使用HBase shell中的“alter”命令修改TTL。
hbase.backup.attempts.max：获取hbase表快照时执行的尝试次数（默认值：10）。
hbase.backup.attempts.pause.ms：失败的快照尝试之间等待的时间（以毫秒为单位）（默认值：10000）。
hbase.backup.logroll.timeout.millis：等待RegionServers在Master的过程框架中执行WAL滚动的时间（以毫秒为单位）（默认值：30000）。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/132/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百三十二、HBase合并增量备份映像" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百三十二、HBase合并增量备份映像" href="/docs/bigdata/hbase/132/">一百三十二、HBase合并增量备份映像</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">合并增量备份映像 此命令可用于将两个或多个增量备份映像合并为单个增量备份映像。这可用于将多个小型增量备份映像合并为一个较大的增量备份映像。此命令可用于将每小时增量备份合并到每日增量备份映像中，或将每日增量备份合并到每周增量备份中。
1$ hbase backup merge &lt;backup_ids&gt; 位置命令行参数 # backup_ids
以逗号分隔的增量备份映像ID列表，它们将组合到单个映像中。
命名命令行参数 # 没有。
用法示例 1$ hbase backup merge backupId_1467823988425,backupId_1467827588425</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/138/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百三十八、HBase备份修复命令" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百三十八、HBase备份修复命令" href="/docs/bigdata/hbase/138/">一百三十八、HBase备份修复命令</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">备份修复命令 此命令尝试更正由于软件错误或未处理的失败方案而存在的持久备份元数据中的任何不一致之处。虽然备份实现尝试自行更正所有错误，但在系统无法自动恢复的情况下，此工具可能是必需的。
1$ hbase backup repair 位置命令行参数 # 没有。
命名命令行参数 没有。
用法示例 1$ hbase backup repair</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/130/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百三十、Hbase创建备份映像" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百三十、Hbase创建备份映像" href="/docs/bigdata/hbase/130/">一百三十、Hbase创建备份映像</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">创建备份映像 对于也使用Apache Phoenix的HBase群集: 包括备份中的SQL系统目录表。在需要还原HBase备份的情况下，对系统目录表的访问可以帮助您恢复Phoenix与还原的数据的互操作性。
运行备份和还原实用程序的第一步是执行完整备份，并将数据存储在与源不同的映像中。至少，您必须执行此操作才能获得基准，然后才能依赖增量备份。
以HBase超级用户身份运行以下命令：
1hbase backup create &lt;type&gt; &lt;backup_path&gt; 命令完成运行后，控制台将显示SUCCESS或FAILURE状态消息。SUCCESS消息包括备份ID，备份ID是HBase主机从客户端收到备份请求的Unix时间（也称为Epoch时间）。
记录在成功备份结束时出现的备份ID。如果源群集出现故障，并且您需要使用还原操作恢复数据集，则具有可用的备份ID可以节省时间。
位置命令行参数 # type
要执行的备份类型：完整备份或增量备份。提醒一下，增量备份需要已完全备份。
BACKUP_PATH
该BACKUP_PATH参数指定来存储备份映像文件系统的完整URI的地方。有效的前缀是hdfs：，webhdfs：，gpfs：和s3fs :
命名命令行参数 # -t&lt;table_name [，table_name]&gt;
要备份的以逗号分隔的表列表。如果未指定表，则备份所有表。不存在正则表达式或通配符支持; 必须明确列出所有表名。有关对表集合执行操作的详细信息，请参阅备份集（这将在之后的章节中进行介绍）。与-s选项互斥；其中一个命名选项是必需的。
-s&lt;backup_set_name&gt;
根据备份集确定要备份的表。有关备份集的用途和用法，请参阅使用备份集。与-t选项互斥。
-w&lt;number_workers&gt;
（可选）指定将数据复制到备份目标的并行工作器数。备份当前由MapReduce作业执行，因此该值对应于作业将生成的Mapper数。
-b&lt;bandwidth_per_worker&gt;
（可选）指定每个工作线程的带宽，以MB/秒为单位。
-d
（可选）启用“DEBUG”模式，该模式打印有关备份创建的其他日志记录。
-q
（可选）允许指定应在其中执行创建备份的MapReduce作业的YARN队列的名称。此选项有助于防止备份任务从其他高重要性MapReduce作业中窃取资源。
用法示例 1$ hbase backup create full hdfs://host5:8020/data/backup -t SALES2,SALES3 -w 3 此命令在HDFS实例中创建两个表SALES2和SALES3的完整备份映像，这两个表在路径/data/backup中的NameNode为host5:8020。w选项指定不超过三个并行工作完成操作。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/171/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十一、HBase性能调整：网络" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十一、HBase性能调整：网络" href="/docs/bigdata/hbase/171/">一百七十一、HBase性能调整：网络</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">网络 避免网络问题降低Hadoop和HBase性能的最重要因素可能是所使用的交换硬件，在项目范围的早期做出的决策可能会导致群集大小增加一倍或三倍（或更多）时出现重大问题。
需要考虑的重要事项：
切换设备的容量 连接的系统数量 上行链路容量 单个交换机 此配置中最重要的一个因素是硬件的交换容量能够处理连接到交换机的所有系统可以生成的通信量。一些较低价格的商用硬件可以具有比完整交换机可以使用的更慢的交换容量。
多个交换机 多个交换机是架构中的潜在缺陷。低价硬件的最常见配置是从一个交换机到另一个交换机的简单1Gbps上行链路。这种经常被忽视的夹点很容易成为集群通信的瓶颈。特别是对于读取和写入大量数据的MapReduce作业，此上行链路上的通信可能会饱和。
缓解这个问题非常简单，可以通过多种方式实现：
使用适当的硬件来处理您尝试构建的群集的规模。 使用较大的单个交换机配置，即单个48端口，而不是2个24端口 为上行链路配置端口中继，以利用多个接口来增加交叉交换机带宽。 多个机架 多个机架配置具有与多个交换机相同的潜在问题，并且可能会从两个主要方面降低性能：
交换容量性能不佳 上行链路到另一个机架的能力不足 如果机架中的交换机具有适当的交换容量以全速处理所有主机，则下一个最可能出现的问题将是通过在机架中引导更多群集引起的。跨越多个机架时避免问题的最简单方法是使用端口中继来创建到其他机架的绑定上行链路。然而，这种方法的缺点是可能使用的端口开销。例如，从机架A到机架B创建一个8Gbps端口通道，使用24个端口中的8个在机架之间进行通信会降低投资回报率，但使用太少可能意味着您无法从群集中获得最大的收益。
在机架之间使用10Gbe链接将大大提高性能，并且假设您的交换机支持10Gbe上行链路或允许扩展卡，则允许您为计算机保存端口，而不是上行链路。
网络接口 确认所有网络接口是否都正常运行。
网络一致性和分区容错度 CAP定理指出，分布式系统可以维持以下三种特性中的两种： – *C*onsistency – 所有节点都看到相同的数据。 – *A*vailability – 每个请求都会收到有关它是成功还是失败的响应。 – *P*artition tolerance – 即使其他组件无法使用，系统也会继续运行。
HBase有利于一致性和分区容错度，必须做出决定。Coda Hale解释了为什么分区容错度如此重要，请访问http://codahale.com/you-cant-sacrifice-partition-tolerance/。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/175/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十五、HBase性能调整：一般模式" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十五、HBase性能调整：一般模式" href="/docs/bigdata/hbase/175/">一百七十五、HBase性能调整：一般模式</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">HBase一般模式 常量 当人们开始使用HBase时，他们倾向于编写如下所示的代码：
1Get get = new Get(rowkey); 2Result r = table.get(get); 3byte[] b = r.getValue(Bytes.toBytes(&#34;cf&#34;), Bytes.toBytes(&#34;attr&#34;)); // returns current version of value 但是特别是当内部循环（和MapReduce作业）时，将columnFamily和column-names重复转换为字节数组的成本非常高。最好对字节数组使用常量，如下所示：
1public static final byte[] CF = &#34;cf&#34;.getBytes(); 2public static final byte[] ATTR = &#34;attr&#34;.getBytes(); 3... 4Get get = new Get(rowkey); 5Result r = table.get(get); 6byte[] b = r.getValue(CF, ATTR); // returns current version of value</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/174/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十四、HBase性能调整：架构设计" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十四、HBase性能调整：架构设计" href="/docs/bigdata/hbase/174/">一百七十四、HBase性能调整：架构设计</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">列族数 ##
请参见HBase列族数量。
键和属性长度 因初次访问，为防止爬虫和人机识别，请关注微信公众号，回复:‘验证码‘获取验证码来解锁全文 解锁内容 请参阅：尽量减少行和列的大小。
表RegionSize 在某些表需要不同区域大小而不是配置的默认区域大小的情况下，可以通过在每个表的基础上，通过HTableDescriptor的setFileSize来设置区域大小。
Bloom过滤器 Bloom过滤器是以其创建者Burton Howard Bloom的名字命名的，它是一种数据结构，用于预测给定元素是否属于一组数据。Bloom过滤器的肯定结果并不总是准确的，但否定结果是准确的。Bloom过滤器被设计成对于数据集来说“足够准确”，这些数据集非常大以至于传统的哈希机制是不切实际的。有关Bloom过滤器的更多信息，请参阅http://en.wikipedia.org/wiki/Bloom_filter。
就HBase而言，Bloom过滤器提供了一个轻量级的内存结构，可以将给定Get操作（Bloom过滤器不能与Scans一起使用）的磁盘读取次数减少到仅包含所需行的StoreFiles。潜在的性能增益随着并行读取的数量而增加。
Bloom过滤器本身存储在每个HFile的元数据中，并且永远不需要更新。当因为区域部署到RegionServer而打开HFile时，Bloom过滤器将加载到内存中。
HBase包括一些调整机制，用于折叠Bloom过滤器以减小大小并将误报率保持在一个理想的范围内。
Bloom过滤器在HBASE-1200中引入。从HBase 0.96开始，默认情况下启用基于行的Bloom过滤器。（HBASE-8450）
何时使用Bloom过滤器 从HBase 0.96开始，默认情况下启用基于行的Bloom过滤器。您可以选择禁用它们或更改某些表以使用行+列Bloom过滤器，具体取决于数据的特征以及如何将其加载到HBase中。
要确定Bloom过滤器是否会产生积极影响，请检查RegionServer度量标准中的blockCacheHitRatio值。如果启用了Bloom过滤器，则值blockCacheHitRatio应该增加，因为Bloom过滤器正在过滤掉绝对不需要的块。
您可以选择为行，或行+列组合来启用Bloom过滤器。如果您通常扫描整行，则行+列组合不会提供任何好处。基于行的Bloom过滤器可以对行+列进行Get操作，但不能使用其他方法。但是，如果您有大量的列级别的Puts，以便每个StoreFile中可能存在一行，则基于行的过滤器将始终返回正结果并且不会带来任何好处。除非每行有一列，否则行+列Bloom过滤器需要更多空间，以便存储更多密钥。当每个数据条目的大小至少为几千字节时，Bloom过滤器效果最佳。
当您的数据存储在几个较大的StoreFiles中时，开销将减少，以避免在低级扫描期间额外的磁盘IO找到特定的行。
Bloom过滤器需要在删除时重建，因此可能不适合具有大量删除的环境。
启用Bloom过滤器 在列族上启用Bloom过滤器。您可以使用HColumnDescriptor的setBloomFilterType方法或使用HBase API来完成此操作。有效值是NONE，ROW（默认值），或ROWCOL。
以下示例创建一个表，并在colfam1列族上启用ROWCOL Bloom过滤器。
1hbase&gt; create &#39;mytable&#39;,{NAME =&gt; &#39;colfam1&#39;, BLOOMFILTER =&gt; &#39;ROWCOL&#39;} 配置Bloom过滤器的服务器范围行为 您可以在hbase-site.xml中配置以下设置。
参数 默认值 描述 io.storefile.bloom.enabled
yes
如果出现问题，设置为no以杀死服务器范围内的Bloom过滤器
io.storefile.bloom.error.rate
.01
Bloom过滤器的平均误报率。折叠用于维持误报率。表示为百分比的十进制表示形式。
io.storefile.bloom.max.fold
7
保证最大折叠率。不需要更改此设置，不建议这样做。
io.storefile.bloom.max.keys
1.28
对于默认（单个块）Bloom过滤器，这指定了最大键数。
io.storefile.delete.family.bloom.enabled
true
主开关启用Delete Family Bloom过滤器并将其存储在StoreFile中。
io.storefile.bloom.block.size
131072
目标Bloom块大小。大约这个大小的Bloom过滤器块与数据块交织。
hfile.block.bloom.cacheonwrite
false
为复合Bloom过滤器的内联块启用写入高速缓存。
ColumnFamily BlockSize 可以为表中的每个ColumnFamily配置块大小，默认为64k。较大的单元值需要较大的块大小。块大小和生成的StoreFile索引之间存在反比关系（即，如果blocksize加倍，则结果索引应该大致减半）。
内存ColumnFamilies ColumnFamilies可以选择定义为内存中。数据仍然保留在磁盘上，就像任何其他ColumnFamily一样。内存块在块缓存中具有最高优先级，但不保证整个表将在内存中。</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/174/">阅读更多关于一百七十四、HBase性能调整：架构设计的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/173/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十三、HBase性能调整：配置" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十三、HBase性能调整：配置" href="/docs/bigdata/hbase/173/">一百七十三、HBase性能调整：配置</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">HBase配置 请参阅HBase重要配置一节的内容。
管理压缩 对于较大的系统，管理link:[compactions and splits]可能是您需要考虑的事情。
hbase.regionserver.handler.count 见[hbase.regionserver.handler.count]。
hfile.block.cache.size 请参见[hfile.block.cache.size]。RegionServer进程的内存设置。
Blockcache的预取选项 如果设置了列族或RegionServer属性，HBASE-9857会在打开BlockCache时添加一个新选项来预取HFile内容。此选项适用于HBase 0.98.3及更高版本。目的是在打开缓存后，使用内存中的表数据尽可能快地预热BlockCache，而不是将预取数计为缓存未命中。这对于快速读取非常有用，但如果要预加载的数据不适合BlockCache，则不是一个好主意。它可用于调整预取的IO影响与所有数据块在缓存中的时间之间的关系。
要在给定列族上启用预取，可以使用HBase Shell或使用API。
使用HBase Shell启用预取：
1hbase&gt; create &#39;MyTable&#39;, { NAME =&gt; &#39;myCF&#39;, PREFETCH_BLOCKS_ON_OPEN =&gt; &#39;true&#39; } 使用API启用预取
1// ... 2HTableDescriptor tableDesc = new HTableDescriptor(&#34;myTable&#34;); 3HColumnDescriptor cfDesc = new HColumnDescriptor(&#34;myCF&#34;); 4cfDesc.setPrefetchBlocksOnOpen(true); 5tableDesc.addFamily(cfDesc); 6// ... 要查看运行中的预取，请在hbase-2.0 +中的org.apache.hadoop.hbase.io.hfile.HFileReaderImpl，或在HBase的早期版本，hbase-1.x中的org.apache.hadoop.hbase.io.hfile.HFileReaderV2中启用TRACE级别登录。
hbase.regionserver.global.memstore.size 请参见[hbase.regionserver.global.memstore.size]。通常根据需要为RegionServer进程调整此内存设置。
hbase.regionserver.global.memstore.size.lower.limit 请参见[hbase.regionserver.global.memstore.size.lower.limit]。通常根据需要为RegionServer进程调整此内存设置。
hbase.hstore.blockingStoreFiles 请参见[hbase.hstore.blockingStoreFiles]。如果RegionServer日志中存在阻塞，则增加此值可能有所帮助。
hbase.hregion.memstore.block.multiplier 请参见[hbase.hregion.memstore.block.multiplier]。如果有足够的RAM，增加这个可以帮助。
hbase.regionserver.checksum.verify 让HBase将校验和写入数据块，并保存在读取时必须进行校验和查找。
请参见[hbase.regionserver.checksum.verify]，[hbase.hstore.bytes.per.checksum]和[hbase.hstore.checksum.algorithm]。
调整callQueue选项 HBASE- 11355引入了几种可以提高性能的callQueue调优机制。
要增加callqueue的数量，请设置hbase.ipc.server.num.callqueue为大于1的值。要将callqueue拆分为单独的读写队列，请将hbase.ipc.server.callqueue.read.ratio的值设置为0和1之间。此因素将队列的权重赋给写入（如果低于0.5）或读取（如果高于0.5）。另一种说法是，该因子决定了拆分队列中有多少百分比用于读取。以下示例说明了一些可能性。请注意，无论您使用何种设置，始终至少有一个写入队列。
默认值为0不拆分队列。 值0.3使用30％的队列进行读取，60％用于写入。如果hbase.ipc.server.num.callqueue的给定值为10，则3个队列将用于读取，7个用于写入。 值0.5使用相同数量的读取队列和写入队列。如果hbase.ipc.server.num.callqueue的给定值为10，则将5个队列用于读取，5个用于写入。 值0.6使用60％的队列进行读取，30％用于写入。如果hbase.ipc.server.num.callqueue的给定值为10，则7个队列将用于读取，3个用于写入。 值1.0使用一个队列来处理写请求，所有其他队列处理读请求。高于的值1.0具有与值相同的效果1.0。如果hbase.ipc.server.num.callqueue的给定值为10，则9个队列将用于读取，1个用于写入。 您还可以拆分读取队列，以便通过设置hbase.ipc.server.callqueue.scan.ratio选项将单独的队列用于短读取（来自Get操作）和长读取（来自Scan操作）。此选项是介于0和1之间的一个因子，它决定了用于获取和扫描的读取队列的比率。如果值低于0.5，则使用更多队列用于获取，如果值高于0.5，则使用更多队列进行扫描。无论您使用何种设置，至少有一个读取队列用于Get操作。
值为0不会拆分读取队列。 一个值0.3使用60％的读取队列来用于获取，30％用于扫描。如果hbase.ipc.server.num.callqueue给定的值为20，并且hbase.ipc.server.callqueue.read.ratio的值为0.5，那么10个队列将用于读取，在这10个队列中，7个队列用于获取，3个队列用于扫描。 一个值0.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/173/">阅读更多关于一百七十三、HBase性能调整：配置的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/177/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十七、从HBase读取" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十七、从HBase读取" href="/docs/bigdata/hbase/177/">一百七十七、从HBase读取</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">从HBase读取 如果您遇到性能问题，邮件列表可以提供帮助。例如，这里有一个关于解决读取时间问题的一个很好的通用线程：Scan scan = new Scan(); scan.addColumn(…); scan.setAttribute(Scan.HINT_LOOKAHEAD, Bytes.toBytes(2)); table.getScanner(scan); 关闭ResultScanners [这不仅仅是提高性能，而是避免性能问题。如果忘记关闭ResultScanners，可能会导致RegionServers出现问题。始终将ResultScanner处理包含在try/catch块中。
```java
Scan scan = new Scan(); // set attrs... ResultScanner rs = table.getScanner(scan); try { for (Result r = rs.next(); r != null; r = rs.next()) { // process result... } finally { rs.close(); // always close the ResultScanner! table.close();
```end
块缓存
可以通过该setCacheBlocks方法将扫描实例设置为使用RegionServer中的块缓存。对于输入扫描到MapReduce作业，这应该是false。对于频繁访问的行，建议使用块缓存。]Scan scan _ new Scan_ scan.addColumn_…_ scan.setAttribute_Scan.HINT_LOOKAHEAD_ Bytes.toBytes_2_ table.getScanner_scan_
通过在堆外移动块缓存来缓存更多数据。请参阅[堆外块缓存][Link1]。
行键的最佳加载 执行只需要行键的表扫描（没有族，限定符，值或时间戳）时，请使用setFilter向扫描仪添加带有MUST_PASS_ALL运算符的FilterList。筛选器列表应包括FirstKeyOnlyFilter和KeyOnlyFilter。使用此筛选器组合将导致最坏的情况，即RegionServer从磁盘读取单个值，并为单个行将最小的网络流量发送到客户端。
并发：监控数据传播 执行大量并发读取时，监视目标表的数据传播。如果目标表具有的区域太少，则可能从太少的节点提供读取。
请参阅[表创建：预创建区域][Link2]以及[HBase配置][HBase]
Bloom过滤器 启用Bloom过滤器可以节省您的磁盘空间，并有助于改善读取延迟。</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/177/">阅读更多关于一百七十七、从HBase读取的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/176/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十六、HBase相关内容" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十六、HBase相关内容" href="/docs/bigdata/hbase/176/">一百七十六、HBase相关内容</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">批量加载 如果可以，请使用批量加载工具。请参阅HBase批量加载。否则，请注意以下内容。
表创建：预创建区域 默认情况下，HBase中的表最初是使用一个区域创建的。对于批量导入，这意味着所有客户端都将写入同一区域，直到它足够大，可以拆分并在集群中分布。加速批量导入过程的一个有用模式是预先创建空白区域。在这方面要保守一点，因为太多的区域实际上会降低性能。
使用HBase API预创建拆分有两种不同的方法。第一种方法是依靠默认Admin策略（在Bytes.split中实现）……
1byte[] startKey = ...; // your lowest key 2byte[] endKey = ...; // your highest key 3int numberOfRegions = ...; // of regions to create 4admin.createTable(table, startKey, endKey, numberOfRegions); 而使用HBase API的另一种方法是自己定义拆分…
1byte[][] splits = ...; // create your own splits 2admin.createTable(table, splits); 使用HBase Shell可以通过指定拆分选项来创建表，从而实现类似的效果。
1# create table with specific split points 2hbase&gt;create &#39;t1&#39;,&#39;f1&#39;,SPLITS =&gt; [&#39;\x10\x00&#39;, &#39;\x20\x00&#39;, &#39;\x30\x00&#39;, &#39;\x40\x00&#39;] 3# create table with four regions based on random bytes keys 4hbase&gt;create &#39;t2&#39;,&#39;f1&#39;, { NUMREGIONS =&gt; 4 , SPLITALGO =&gt; &#39;UniformSplit&#39; } 5# create table with five regions based on hex keys 6create &#39;t3&#39;,&#39;f1&#39;, { NUMREGIONS =&gt; 5, SPLITALGO =&gt; &#39;HexStringSplit&#39; } 有关理解键空间和预创建区域的相关问题，请参阅RowKeys和区域分割之间的关系。有关手动预分割区域的讨论，请参阅手动拆分区域决策。有关使用HBase shell预拆分表的详细信息，请参阅使用HBase shell预分割表。</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/176/">阅读更多关于一百七十六、HBase相关内容的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/179/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十九、HDFS的工作方式" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十九、HDFS的工作方式" href="/docs/bigdata/hbase/179/">一百七十九、HDFS的工作方式</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">HDFS 因为HBase在HDFS上运行，所以了解它如何工作以及它如何影响HBase非常重要。
低延迟读取的当前问题 HDFS的原始用例是批处理。因此，低延迟读取在历史上不是优先事项。随着Apache HBase的日益普及，这种情况正在发生变化，并且已经在开发中进行了一些改进。有关HBase的HDFS改进，请参阅Umbrella Jira Ticket。
利用本地数据 由于Hadoop 1.0.0（也是0.22.1,0.23.1，CDH3u3和HDP 1.0）通过HDFS-2246，当数据是本地的，DFSClient可以进行“短路”并直接从磁盘读取而不是通过DataNode。对于HBase来说，这意味着RegionServers可以直接读取其计算机的磁盘，而不必打开socket与DataNode通信，前者通常要快得多。请参阅JD的Performance Talk。另请参阅HBase，mail＃dev – read short circuit以获得有关short circuit读取的更多讨论。
要启用“short circuit”读取，它将取决于您的Hadoop版本。在HDFS-347中，Hadoop 2中的原始shortcircuit补丁得到了很大改进。请参阅http://blog.cloudera.com/blog/2013/08/how-improved-short-circuit-local-reads-bring-better-performance-and-security-to-hadoop/，以有关新旧实现的区别。请参阅Hadoop shortcircuit读取配置页面，了解如何启用后者，更好的shortcircuit版本。例如，这是一个最小配置。启用添加到hbase-site.xml的short-circuit：
1&lt;property&gt; 2 &lt;name&gt;dfs.client.read.shortcircuit&lt;/name&gt; 3 &lt;value&gt;true&lt;/value&gt; 4 &lt;description&gt; 5 This configuration parameter turns on short-circuit local reads. 6 &lt;/description&gt; 7&lt;/property&gt; 8&lt;property&gt; 9 &lt;name&gt;dfs.domain.socket.path&lt;/name&gt; 10 &lt;value&gt;/home/stack/sockets/short_circuit_read_socket_PORT&lt;/value&gt; 11 &lt;description&gt; 12 Optional. This is a path to a UNIX domain socket that will be used for 13 communication between the DataNode and local HDFS clients.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/179/">阅读更多关于一百七十九、HDFS的工作方式的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/172/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十二、HBase性能调整：Java GC" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十二、HBase性能调整：Java GC" href="/docs/bigdata/hbase/172/">一百七十二、HBase性能调整：Java GC</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">Java GC和Apache HBase 垃圾回收(GC)机制长时间暂停 在Todd Lipcon的演示中，使用MemStore-Local Allocation Buffers避免使用完整的GC（http://www.slideshare.net/cloudera/hbase-hug-presentation），描述了HBase中常见的两种停止垃圾收集的情况，特别是在加载过程中；CMS故障模式和和老一代堆碎片带来的。
要解决第一个问题，请通过添加-XX:CMSInitiatingOccupancyFraction默认值并将其设置为默认值来启动早于默认值的CMS 。从60％或70％开始（降低阈值，完成的GCing越多，使用的CPU越多）。
为了解决第二个碎片问题，Todd补充实验设施（MSLAB，全称是 MemStore-Local Allocation Buffer），必须在Apache HBase 0.90.x明确启用（它默认是在Apache HBase 0.92.x的）。在你的Configuration中设置hbase.hregion.memstore.mslab.enabled为true。最新的JVM更好地考虑碎片，因此请确保您运行的是最新版本。在消息中读出，识别由碎片引起的并发模式故障。请注意，启用后，每个MemStore实例将至少占用一个MSLAB内存实例。如果您有数千个区域或许多区域，每个区域都有许多列族，那么MSLAB的这种分配可能会负责堆分配的很大一部分，并且在极端情况下会导致OOME。在这种情况下禁用MSLAB，或者降低它使用的内存量，或者减少每个服务器的区域。
如果您的工作负载很大，请查看HBASE-8163 MemStoreChunkPool：使用MSLAB时对JAVA GC的改进（https://issues.apache.org/jira/browse/HBASE-8163）。它描述了在写入负载期间降低Young代GC数量的配置。
如果你没有安装HBASE-8163，和你想提高你的Young代GC时间，那么需要考虑的一个技巧是在hbase-env.sh中设置GC配置-XX:PretenureSizeThreshold，让它的大小比hbase.hregion.memstore.mslab.chunksize的大小要小一些，所以MSLAB分配直接发生在tenured空间而不是Young代。你这样做是因为这些MSLAB分配无论如何都可能使它成为Old代，而不是在eden空间中承受来自s0和s1之间的复制的代价，然后在MSLAB取得了足够的tenure后，从Young代复制到Old代，这节省了一点YGC流失并直接分配到Old代。
还要考虑启用堆外块缓存。这已被证明可以缓解GC暂停时间。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/178/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十八、从HBase删除" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十八、从HBase删除" href="/docs/bigdata/hbase/178/">一百七十八、从HBase删除</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">从HBase删除 使用HBase表作为队列 HBase表有时用作队列。在这种情况下，必须特别注意定期对以这种方式使用的表格进行主要压缩。如数据模型中所述，将行标记为已删除会创建其他StoreFiles，然后需要在读取时对其进行处理。
删除RPC行为 请注意，Table.delete(Delete)不使用writeBuffer。它将在每次调用时执行RegionServer RPC。对于大量删除，请考虑使用：Table.delete(List)。
请参阅hbase.client.Delete</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/170/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百七十、HBase性能调整：操作系统" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百七十、HBase性能调整：操作系统" href="/docs/bigdata/hbase/170/">一百七十、HBase性能调整：操作系统</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">操作系统 内存 HBase一定需要RAM！
64位 使用64位平台（和64位JVM）。
交换 # 注意交换，将swappiness设为0。
CPU 确保已将Hadoop设置为使用本机的硬件校验和。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/161/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十一、Spark Streaming" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十一、Spark Streaming" href="/docs/bigdata/hbase/161/">一百六十一、Spark Streaming</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">Spark Streaming Spark Streaming是一个基于Spark构建的微批处理流处理框架。HBase和Spark Streaming是一个很好的搭档，因为HBase可以与Spark Streaming一起提供以下好处：
即时获取参考数据或配置文件数据的地方 以支持仅一次处理的Spark Streaming承诺的方式存储计数或聚合的位置。 HBase-Spark模块与Spark Streaming的集成点类似于其常规的Spark集成点，因为以下命令可以直接通过Spark Streaming DStream实现。
bulkPut
用于向HBase大规模并行发送put
bulkDelete
用于向HBase大规模并行发送delete
bulkGet
用于大规模并行发送get到HBase以创建一个新的RDD
mapPartition
使用Connection对象执行Spark Map函数，以允许完全访问HBase
hBaseRDD
简化分布式扫描以创建RDD
带有DStream的bulkPut示例
下面是使用DStreams的bulkPut示例。RDD批量放置的感觉非常接近。
1val sc = new SparkContext(&#34;local&#34;, &#34;test&#34;) 2val config = new HBaseConfiguration() 3val hbaseContext = new HBaseContext(sc, config) 4val ssc = new StreamingContext(sc, Milliseconds(200)) 5val rdd1 = ... 6val rdd2 = ... 7val queue = mutable.Queue[RDD[(Array[Byte], Array[(Array[Byte], 8 Array[Byte], Array[Byte])])]]() 9queue += rdd1 10queue += rdd2 11val dStream = ssc.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/161/">阅读更多关于一百六十一、Spark Streaming的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/165/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十五、Apache HBase协处理器的类型" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十五、Apache HBase协处理器的类型" href="/docs/bigdata/hbase/165/">一百六十五、Apache HBase协处理器的类型</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">协处理器的类型 观察者协处理器 在特定事件发生之前或之后触发观察者协处理器。在事件之前发生的观察者使用以pre前缀开头的方法，例如，prePut。观察者发生在以post前缀（如postPut）开头的事件覆盖方法之后。
用于观察者协处理器的用例 安全
在执行Get或Put操作之前，您可以使用preGet或prePut方法检查权限。
参照完整性
HBase不直接支持refential完整性的RDBMS概念，也称为外键。您可以使用协处理器来强制执行此类完整性。例如，如果您有一个业务规则，users表中的每个插入必须后跟user_daily_attendance表中的相应条目，您可以实现协处理器以在user使用该prePut方法向user_daily_attendance插入记录。
二级索引
您可以使用协处理器来维护二级索引。
观察者协处理器的类型 RegionObserver
RegionObserver协处理器允许您观察区域上的事件，例如Get 和Put操作。
RegionServerObserver
RegionServerObserver允许您观察与RegionServer操作相关的事件，例如启动，停止或执行合并，提交或回滚。
MasterObserver
MasterObserver允许您观察与HBase Master相关的事件，例如表创建，删除或架构修改。
WalObserver
WalObserver允许您观察与写入预写日志（WAL）相关的事件。
示例提供了观察者协处理器的工作示例。
端点协处理器 端点处理器允许您在数据位置执行计算。例如，需要计算横跨数以百计区域的整个表的运行平均值或求和。
与您的代码透明运行的观察器协处理器相比，端点协处理器必须使用Table或HTable中提供的CoprocessorService()方法显式调用。
从HBase 0.96开始，端点协处理器使用Google Protocol Buffers（protobuf）实现。以0.94版本编写的端点协处理器与0.96或更高的版本不兼容。见HBASE-5448）。要将HBase群集从0.94或更早版本升级到0.96或更高版本，您需要重新实现协处理器。
协处理器端点不应使用HBase内部构件，只能利用公共API；理想情况下，CPEP应仅依赖于接口和数据结构。这并不总是可行的，但要注意这样做会使端点变脆弱，随着HBase内部的发展而易于破损。注释为私有或演进的HBase内部API在删除之前不必遵守语义版本规则或关于弃用的一般Java规则。虽然生成的protobuf文件没有hbase受众注释 – 它们是由protobuf protoc工具创建的，它不知道HBase是如何工作的 – 它们应该被认为是@InterfaceAudience.Private，因此容易改变。
在接下来的“示例”一节，提供了端点协处理器的工作示例。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/164/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十四、Apache HBase协处理器概述" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十四、Apache HBase协处理器概述" href="/docs/bigdata/hbase/164/">一百六十四、Apache HBase协处理器概述</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">协处理器概述 在HBase中，使用“Get”或者“Scan”获取数据，而在RDBMS中使用SQL查询。为了仅获取相关数据，您可以使用HBase Filter过滤它 ，而在RDBMS中使用WHERE谓词。
获取数据后，您可以对其执行计算。这种范例适用于具有几千行和几列的“小数据”。但是，当您扩展到数十亿行和数百万列时，在网络中移动大量数据将在网络层产生瓶颈，客户端需要足够强大并且有足够的内存来处理大量数据和计算。此外，客户端代码可能变得庞大而复杂。
在这种情况下，协处理器可能有意义。您可以将业务计算代码放入在RegionServer上运行的协处理器中，与数据位于同一位置，并将结果返回给客户端。
这只是使用协处理器可以带来好处的一种情况。以下是一些类比，可能有助于解释协处理器的一些好处。
协处理器类比 触发器和存储过程
Observer协处理器类似于RDBMS中的触发器，因为它在特定事件（例如，Get或Put）发生之前或之后执行代码。端点协处理器类似于RDBMS中的存储过程，因为它允许您对RegionServer本身上的数据而不是客户端上的数据执行自定义计算。
MapReduce
MapReduce的工作原理是将计算移动到数据位置。协处理器在相同的主体上运行。
AOP
如果您熟悉面向方面编程（AOP），则可以将协处理器视为通过拦截请求然后运行某些自定义代码来应用建议，然后将请求传递到其最终目标（甚至更改目标）。
协处理器实现概述 1、 您的类应该实现一个协处理器接口–协处理器，RegionObserver，CoprocessorService–仅举几例；
2、 使用HBaseShell静态或动态地加载协处理器；
3、 从客户端代码调用协处理器HBase透明地处理协处理器；
框架API在协处理器包中提供。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">3 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/163/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十三、SparkSQL – DataFrames" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十三、SparkSQL – DataFrames" href="/docs/bigdata/hbase/163/">一百六十三、SparkSQL – DataFrames</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">SparkSQL / DataFrames HBase-Spark连接器（在HBase-Spark模块中）利用Spark-1.2.0中引入的DataSource API （SPARK-3247），弥补了简单HBase KV存储和复杂关系SQL查询之间的差距，使用户能够使用Spark在HBase上执行复杂的数据分析工作。HBase Dataframe是标准的Spark Dataframe，能够与任何其他数据源（如Hive，Orc，Parquet，JSON等）进行交互。HBase-Spark Connector应用关键技术，如分区修剪，列修剪，谓词叠加和数据局部性。
要使用HBase-Spark连接器，用户需要为HBase和Spark表之间的模式映射定义Catalog，准备数据并填充HBase表，然后加载HBase DataFrame。之后，用户可以使用SQL查询在HBase表中进行集成查询和访问记录。以下说明了基本程序。
定义目录 1def catalog = s&#34;&#34;&#34;{ 2 |&#34;table&#34;:{&#34;namespace&#34;:&#34;default&#34;, &#34;name&#34;:&#34;table1&#34;}, 3 |&#34;rowkey&#34;:&#34;key&#34;, 4 |&#34;columns&#34;:{ 5 |&#34;col0&#34;:{&#34;cf&#34;:&#34;rowkey&#34;, &#34;col&#34;:&#34;key&#34;, &#34;type&#34;:&#34;string&#34;}, 6 |&#34;col1&#34;:{&#34;cf&#34;:&#34;cf1&#34;, &#34;col&#34;:&#34;col1&#34;, &#34;type&#34;:&#34;boolean&#34;}, 7 |&#34;col2&#34;:{&#34;cf&#34;:&#34;cf2&#34;, &#34;col&#34;:&#34;col2&#34;, &#34;type&#34;:&#34;double&#34;}, 8 |&#34;col3&#34;:{&#34;cf&#34;:&#34;cf3&#34;, &#34;col&#34;:&#34;col3&#34;, &#34;type&#34;:&#34;float&#34;}, 9 |&#34;col4&#34;:{&#34;cf&#34;:&#34;cf4&#34;, &#34;col&#34;:&#34;col4&#34;, &#34;type&#34;:&#34;int&#34;}, 10 |&#34;col5&#34;:{&#34;cf&#34;:&#34;cf5&#34;, &#34;col&#34;:&#34;col5&#34;, &#34;type&#34;:&#34;bigint&#34;}, 11 |&#34;col6&#34;:{&#34;cf&#34;:&#34;cf6&#34;, &#34;col&#34;:&#34;col6&#34;, &#34;type&#34;:&#34;smallint&#34;}, 12 |&#34;col7&#34;:{&#34;cf&#34;:&#34;cf7&#34;, &#34;col&#34;:&#34;col7&#34;, &#34;type&#34;:&#34;string&#34;}, 13 |&#34;col8&#34;:{&#34;cf&#34;:&#34;cf8&#34;, &#34;col&#34;:&#34;col8&#34;, &#34;type&#34;:&#34;tinyint&#34;} 14 |} 15 |}&#34;&#34;&#34;.stripMargin Catalog定义了HBase和Spark表之间的映射。该目录有两个关键部分。一个是rowkey定义，另一个是Spark中的表列与HBase中的列族和列限定符之间的映射。上面定义了一个HBase表的模式，其名称为table1，行键为key，列数为col1 -col8。请注意，还必须将rowkey详细定义为column (col0)，该列具有特定的cf（rowkey）。
保存DataFrame 1case class HBaseRecord( 2 col0: String, 3 col1: Boolean, 4 col2: Double, 5 col3: Float, 6 col4: Int, 7 col5: Long, 8 col6: Short, 9 col7: String, 10 col8: Byte) 11object HBaseRecord 12{ 13 def apply(i: Int, t: String): HBaseRecord = { 14 val s = s&#34;&#34;&#34;row${&#34;%03d&#34;.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/163/">阅读更多关于一百六十三、SparkSQL – DataFrames的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">4 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/167/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十七、HBase观察者协处理器示例" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十七、HBase观察者协处理器示例" href="/docs/bigdata/hbase/167/">一百六十七、HBase观察者协处理器示例</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">示例 HBase提供了Observer Coprocessor（观察者协处理器）的示例。
下面给出更详细的例子。
这些示例假设一个名为users的表，其中有两个列族personalDet和salaryDet，包含个人和工资详细信息。下面是users表格：
personalDet salaryDet jverne
Jules Verne 02/08/1828 12000
9000
3000
rowkey name lastname dob gross net allowances admin Admin Admin cdickens
Charles Dickens 02/07/1812 10000
8000
2000
观察者示例 以下Observer协处理器可防止用户admin的详细信息在users表Get或者Scan中返回。
1、 编写一个实现RegionObserver类的类；
2、 重写preGetOp()方法（不推荐使用该preGet()方法）以检查客户端是否已使用admin值查询rowkey如果是，则返回空结果否则，正常处理请求；
3、 将您的代码和依赖项放在JAR文件中；
4、 将JAR放在HDFS中，HBase可以在其中找到它；
5、 加载协处理器；
6、 写一个简单的程序来测试它；
以下是上述步骤的实现：
1public class RegionObserverExample implements RegionObserver { 2 private static final byte[] ADMIN = Bytes.toBytes(&#34;admin&#34;); 3 private static final byte[] COLUMN_FAMILY = Bytes.toBytes(&#34;details&#34;); 4 private static final byte[] COLUMN = Bytes.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/167/">阅读更多关于一百六十七、HBase观察者协处理器示例的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">2 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/166/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十六、Apache HBase加载协处理器" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十六、Apache HBase加载协处理器" href="/docs/bigdata/hbase/166/">一百六十六、Apache HBase加载协处理器</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">加载协处理器 要使您的协处理器可用于HBase，必须静态（通过HBase配置）或动态（使用HBase Shell或Java API）加载它。
静态加载 请按照以下步骤静态加载协处理器。请记住，必须重新启动HBase才能卸载已静态加载的协处理器。
1、 在hbase-site.xml中定义协处理器，其中元素带有和子元素应该是以下之一：；
1 * 对于RegionObservers和Endpoints是hbase.coprocessor.region.classes。 2 * 对于WALObservers是hbase.coprocessor.wal.classes。 3 * 对于MasterObservers是hbase.coprocessor.master.classes。 4 &lt;value&gt;必须包含协处理器实现类的完全限定类名。 5 例如，要加载协处理器（在类SumEndPoint.java中实现），您必须在RegionServer的&#39;hbase-site.xml&#39;文件中创建以下条目（通常位于&#39;conf&#39;目录下）： 1 &lt;property&gt; 2 &lt;name&gt;hbase.coprocessor.region.classes&lt;/name&gt; 3 &lt;value&gt;org.myname.hbase.coprocessor.endpoint.SumEndPoint&lt;/value&gt; 4 &lt;/property&gt; 1 如果为加载指定了多个类，则类名必须以逗号分隔。框架尝试使用默认的类加载器加载所有已配置的类。因此，jar文件必须驻留在服务器端HBase类路径中。 2 以这种方式加载的协处理器将在所有表的所有区域上处于活动状态。这些也称为系统协处理器。将为第一个列出的协处理器分配优先级Coprocessor.Priority.SYSTEM。列表中的每个后续协处理器的优先级值都会增加1（这会降低其优先级，因为优先级具有整数的自然排序顺序）。 3 当调用注册的观察者时，框架以其优先级的排序顺序执行其回调方法。关系是任意破坏的。 2、 将您的代码放在HBase的类路径上一种简单的方法是将jar（包含代码和所有依赖项）放入HBase的安装目录lib/中；
3、 重启HBase；
静态卸载 1、 从hbase-site.xml中删除协处理器的元素，包括子元素；
2、 重启HBase；
3、 （可选）从类路径或HBase的lib/目录中删除协处理器的JAR文件；
动态加载 您也可以动态加载协处理器，而无需重新启动HBase。这似乎比静态加载更好，但动态加载的协处理器是基于每个表加载的，并且只能用于加载它们的表。因此，动态加载的表有时称为表协处理器（Table Coprocessor）。
此外，动态加载协处理器充当表上的模式更改，并且必须使表脱机以加载协处理器。
有三种方法可以动态加载协处理器。
以下说明做了如下假设：
一个叫做coprocessor.jar的JAR包含了协处理器实现以及它的所有依赖项。 该JAR在HDFS中的某些位置 (如，hdfs:// : /user/ /coprocessor.jar ) 中可用。 使用HBase Shell # 1、 使用HBaseShell禁用表：；
1 hbase&gt; disable &#39;users&#39; 2、 使用如下命令加载协处理器：；</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/166/">阅读更多关于一百六十六、Apache HBase加载协处理器的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/169/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十九、HBase限制协处理器的使用" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十九、HBase限制协处理器的使用" href="/docs/bigdata/hbase/169/">一百六十九、HBase限制协处理器的使用</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">限制协处理器的使用 在多租户环境中，限制任意用户协处理器可能是一个很大的问题。HBase提供了连续的选项，以确保只有预期的协处理器运行：
hbase.coprocessor.enabled：启用或禁用所有协处理器。这将限制HBase的功能，因为禁用所有协处理器将禁用某些安全提供程序。一个受影响的示例是org.apache.hadoop.hbase.security.access.AccessController。
hbase.coprocessor.user.enabled：启用或禁用在表（即用户协处理器）上加载协处理器。
在hbase-site.xml中，可以通过以下可调参数静态加载协处理器：
hbase.coprocessor.regionserver.classes：由区域服务器加载的以逗号分隔的协处理器列表； hbase.coprocessor.region.classes：逗号分隔的RegionObserver和Endpoint协处理器列表； hbase.coprocessor.user.region.classes：由所有区域加载的以逗号分隔的协处理器列表； hbase.coprocessor.master.classes：由主服务器（MasterObserver协处理器）加载的以逗号分隔的协处理器列表； hbase.coprocessor.wal.classes：要加载的以逗号分隔的WALObserver协处理器列表； hbase.coprocessor.abortonerror：如果协处理器应该出错而不是IOError，是否中止已加载协处理器的守护进程。如果将此设置为false，并且访问控制器协处理器应该有致命错误，则将绕过协处理器，因此在安全安装中应建议为true；但是，可以在每个表的基础上为用户协处理器重写此操作，以确保它们不会中止其运行区域服务器，而是在出错时卸载。
hbase.coprocessor.region.whitelist.paths：可用于加载org.apache.hadoop.hbase.security.access.CoprocessorWhitelistMasterObserver的逗号分隔列表，通过这个列表，人们可以使用下列选项来加载协处理器的白名单路径。
类路径上的协处理器隐式列入白名单； *通配符所有协处理器路径； 整个文件系统（例如，hdfs://my-cluster/）； 由FilenameUtils.wildcardMatch计算的通配符路径； 注意：路径可以指定方案或不指定方案（例如，file:///usr/hbase/lib/coprocessors或所有文件系统：/usr/hbase/lib/coprocessors）</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">2 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/162/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十二、使用Spark将数据批量加载到HBase" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十二、使用Spark将数据批量加载到HBase" href="/docs/bigdata/hbase/162/">一百六十二、使用Spark将数据批量加载到HBase</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">使用Spark将数据批量加载到HBase有两种选择。有一些基本的批量加载功能适用于行具有数百万列的情况和未整合列的情况，以及Spark批量加载过程的映射侧之前的分区。
Spark还有一个精简记录批量加载选项，第二个选项是为每行少于10k列的表设计的。第二个选项的优点是Spark shuffle操作的吞吐量更高，而且负载更少。
这两种实现的工作方式或多或少类似于MapReduce批量加载过程，因为分区器根据区域拆分对rowkeys进行分区，并且行键按顺序发送到reducer，以便HFiles可以直接从reduce阶段写出。
在Spark术语中，批量加载将围绕Spark repartitionAndSortWithinPartitions实现，然后是Spark foreachPartition。
首先让我们看一下使用基本批量加载功能的示例
批量加载实例
以下示例显示了Spark的批量加载：
1val sc = new SparkContext(&#34;local&#34;, &#34;test&#34;) 2val config = new HBaseConfiguration() 3val hbaseContext = new HBaseContext(sc, config) 4val stagingFolder = ... 5val rdd = sc.parallelize(Array( 6 (Bytes.toBytes(&#34;1&#34;), 7 (Bytes.toBytes(columnFamily1), Bytes.toBytes(&#34;a&#34;), Bytes.toBytes(&#34;foo1&#34;))), 8 (Bytes.toBytes(&#34;3&#34;), 9 (Bytes.toBytes(columnFamily1), Bytes.toBytes(&#34;b&#34;), Bytes.toBytes(&#34;foo2.b&#34;))), ... 10rdd.hbaseBulkLoad(TableName.valueOf(tableName), 11 t =&gt; { 12 val rowKey = t._1 13 val family:Array[Byte] = t._2(0)._1 14 val qualifier = t._2(0)._2 15 val value = t.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/162/">阅读更多关于一百六十二、使用Spark将数据批量加载到HBase的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/168/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十八、HBase部署协处理器的准则" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十八、HBase部署协处理器的准则" href="/docs/bigdata/hbase/168/">一百六十八、HBase部署协处理器的准则</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">部署协处理器的准则 捆绑协处理器
您可以将协处理器的所有类捆绑到RegionServer类路径上的单个JAR中，以便于部署。否则，将所有依赖项放在RegionServer的类路径中，以便在RegionServer启动期间加载它们。RegionServer的类路径在RegionServer的hbase-env.sh文件中设置。
自动部署
您可以使用Puppet，Chef或Ansible等工具将协处理器的JAR发送到RegionServers文件系统上的所需位置，然后重新启动每个RegionServer，以自动执行协处理器部署。此类设置的详细信息超出了本文档的介绍范围。
更新协处理器
部署新版本的给定协处理器并不像禁用它、替换JAR和重新启用协处理器那么简单。这是因为除非删除对它的所有当前引用，否则无法在JVM中重新加载类。由于当前JVM引用了现有的协处理器，因此必须通过重新启动RegionServer来重新启动JVM，以便替换它。此行为不应更改。
协处理器日志记录
协处理器框架不提供用于超出标准Java日志记录的API。
协处理器配置
如果您不想从HBase Shell加载协处理器，可以将其配置属性添加到hbase-site.xml。在上一节内容的使用HBase Shell中，设置了两个参数：arg1=1,arg2=2。这些可以添加到hbase-site.xml如下：
1&lt;property&gt; 2 &lt;name&gt;arg1&lt;/name&gt; 3 &lt;value&gt;1&lt;/value&gt; 4&lt;/property&gt; 5&lt;property&gt; 6 &lt;name&gt;arg2&lt;/name&gt; 7 &lt;value&gt;2&lt;/value&gt; 8&lt;/property&gt; 然后，您可以使用以下代码读取配置：
1Configuration conf = HBaseConfiguration.create(); 2Connection connection = ConnectionFactory.createConnection(conf); 3TableName tableName = TableName.valueOf(&#34;users&#34;); 4Table table = connection.getTable(tableName); 5Get get = new Get(Bytes.toBytes(&#34;admin&#34;)); 6Result result = table.get(get); 7for (Cell c : result.rawCells()) { 8 System.out.println(Bytes.toString(CellUtil.cloneRow(c)) 9 + &#34;==&gt; &#34; + Bytes.toString(CellUtil.cloneFamily(c)) 10 + &#34;{&#34; + Bytes.toString(CellUtil.cloneQualifier(c)) 11 + &#34;:&#34; + Bytes.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/168/">阅读更多关于一百六十八、HBase部署协处理器的准则的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/160/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百六十、HBase：基本Spark" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百六十、HBase：基本Spark" href="/docs/bigdata/hbase/160/">一百六十、HBase：基本Spark</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">基本Spark 本节讨论最低和最简单级别的Spark HBase集成。所有其他交互点都建立在此处描述的概念之上。
所有Spark和HBase集成的根源都是HBaseContext。HBaseContext接受HBase配置并将它们推送到Spark执行程序。这允许我们在静态位置为每个Spark Executor建立一个HBase连接。
作为参考，Spark Executors可以与Region Servers位于相同的节点上，也可以位于不同的节点上，不依赖于co-location。将每个Spark Executor都视为多线程客户端应用程序。这允许在执行程序上运行的任何Spark任务访问共享的Connection对象。
HBaseContext用法示例
本示例演示如何使用HBaseContext在Scala的RDD上执行foreachPartition：
1val sc = new SparkContext(&#34;local&#34;, &#34;test&#34;) 2val config = new HBaseConfiguration() 3... 4val hbaseContext = new HBaseContext(sc, config) 5rdd.hbaseForeachPartition(hbaseContext, (it, conn) =&gt; { 6 val bufferedMutator = conn.getBufferedMutator(TableName.valueOf(&#34;t1&#34;)) 7 it.foreach((putRecord) =&gt; { 8. val put = new Put(putRecord._1) 9. putRecord._2.foreach((putValue) =&gt; put.addColumn(putValue._1, putValue._2, putValue._3)) 10. bufferedMutator.mutate(put) 11 }) 12 bufferedMutator.flush() 13 bufferedMutator.close() 14}) 这是在Java中实现的相同示例：
1JavaSparkContext jsc = new JavaSparkContext(sparkConf); 2try { 3 List&lt;byte[]&gt; list = new ArrayList&lt;&gt;(); 4 list.</div><div class="mt-2"><a class="text-secondary" href="/docs/bigdata/hbase/160/">阅读更多关于一百六十、HBase：基本Spark的内容。</a></div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/101/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百零一、HBase自定义拆分策略" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百零一、HBase自定义拆分策略" href="/docs/bigdata/hbase/101/">一百零一、HBase自定义拆分策略</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">自定义拆分策略 您可以使用自定义RegionSplitPolicy（HBase 0.94+）重写默认拆分策略。通常，自定义拆分策略应该扩展HBase的默认拆分策略： IncreasingToUpperBoundRegionSplitPolicy。
该策略可以通过HBase配置或者也可以基于每个表在全局范围内进行设置。
在hbase-site.xml中全局配置拆分策略：
1&lt;property&gt; 2 &lt;name&gt;hbase.regionserver.region.split.policy&lt;/name&gt; 3 &lt;value&gt;org.apache.hadoop.hbase.regionserver.IncreasingToUpperBoundRegionSplitPolicy&lt;/value&gt; 4&lt;/property&gt; 使用Java API在表上配置拆分策略：
1HTableDescriptor tableDesc = new HTableDescriptor(&#34;test&#34;); 2tableDesc.setValue(HTableDescriptor.SPLIT_POLICY, ConstantSizeRegionSplitPolicy.class.getName()); 3tableDesc.addFamily(new HColumnDescriptor(Bytes.toBytes(&#34;cf1&#34;))); 4admin.createTable(tableDesc); 5---- 使用HBase Shell在表上配置拆分策略：
1hbase&gt; create &#39;test&#39;, {METADATA =&gt; {&#39;SPLIT_POLICY&#39; =&gt; &#39;org.apache.hadoop.hbase.regionserver.ConstantSizeRegionSplitPolicy&#39;}},{NAME =&gt; &#39;cf1&#39;} 该策略可以通过使用的HBaseConfiguration或按表进行全局设置：
1HTableDescriptor myHtd = ...; 2myHtd.setValue(HTableDescriptor.SPLIT_POLICY, MyCustomSplitPolicy.class.getName()); 该DisabledRegionSplitPolicy策略阻止手动区域拆分。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/105/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百零五、Scans" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百零五、Scans" href="/docs/bigdata/hbase/105/">一百零五、Scans</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">Scans 当客户端针对表发出扫描时，HBase会为每个区域生成一个RegionScanner对象来提供扫描请求。 该RegionScanner对象包含一个StoreScanner对象列表，每列族一个。 每个StoreScanner对象还包含StoreFileScanner对应的列表，对应于相应列族的每个StoreFile和HFile，以及MemStore的KeyValueScanner对象列表。 这两个列表被合并为一个，该列表按照升序对列表末尾的MemStore扫描对象进行排序。 当一个StoreFileScanner对象被构造时，它与一个MultiVersionConcurrencyControl读取点（即当前的memstoreTS）相关联，过滤出读取点之外的任何新的更新。</div></div></div></div><div class="col"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="安图新"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="安图新" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023年10月21日</span>
<span class="hb-blog-post-reading-time">1 分钟阅读</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">技术教程</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/bigdata/hbase/104/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="一百零四、MEMSTORE" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="一百零四、MEMSTORE" href="/docs/bigdata/hbase/104/">一百零四、MEMSTORE</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/hbase/">HBase</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/hbase/">HBase</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">MEMSTORE MemStore对Store进行内存中修改。修改是Cells / KeyValues。当请求刷新时，当前的MemStore被移动到快照并被清除。HBase将继续处理来自新MemStore和备份快照的编辑，直到刷新器报告刷新成功为止。此时，快照将被丢弃。请注意，当发生刷新时，属于同一区域的MemStore将全部被刷新。
MemStore刷新 因初次访问，为防止爬虫和人机识别，请关注微信公众号，回复:‘验证码‘获取验证码来解锁全文 解锁内容 # MemStore刷新可以在下列任何条件下触发。最小刷新单位是每个区域，而不是单独的MemStore级别。
1、 当MemStore达到hbase.hregion.memstore.flush.size指定的大小时，属于其区域的所有MemStore将被刷新到磁盘；
2、 当整体MemStore使用率达到hbase.regionserver.global.memstore.upperLimit指定的值时，来自各个区域的MemStore将被刷新到磁盘以减少RegionServer中的整体MemStore使用量刷新顺序基于区域MemStore使用的降序区域将刷新它们的MemStore，直到整个MemStore使用率降至或稍低于hbase.regionserver.global.memstore.lowerLimit；
3、 当给定区域服务器的WAL中的WAL日志条目数达到hbase.regionserver.max.logs中指定的值时，来自各个区域的MemStores将被刷新到磁盘以减少WAL中的日志数量刷新顺序基于时间首先刷新具有最早MemStore的区域，直到WAL计数下降到hbase.regionserver.max.logs以下；</div></div></div></div></div></div></div><div class="border-1"><nav class="hb-blog-pagination mb-3" aria-label="Page navigation"><ul class="pagination flex-wrap justify-content-center"><li class="page-item"><a class="page-link" href="/archives/2023/10/page/2/" aria-label="前一页"><span aria-hidden="true">«</span></a></li><li class="page-item"><a class="page-link" href="/archives/2023/10/">1</a></li><li class="page-item"><a class="page-link" href="/archives/2023/10/page/2/">2</a></li><li class="page-item active"><a class="page-link" href="/archives/2023/10/page/3/">3</a></li><li class="page-item"><a class="page-link" href="/archives/2023/10/page/4/">4</a></li><li class="page-item"><a class="page-link" href="/archives/2023/10/page/5/">5</a></li><li class="page-item disabled"><a class="page-link" href="#">...</a></li><li class="page-item"><a class="page-link" href="/archives/2023/10/page/34/">34</a></li><li class="page-item"><a class="page-link" href="/archives/2023/10/page/4/" aria-label="下一页"><span aria-hidden="true">»</span></a></li></ul></nav></div></div></div><footer class="hb-footer pt-4 pt-md-5 pb-2 pb-md-3 bg-body-tertiary"><div class="container-fluid container-lg px-4 px-md-3"><div class="row"><div class="hb-footer-site-info col mb-2 text-center"><div class="h5">程序员安仔</div><ul class="list-unstyled small mb-2"><li class="mt-2">一个只爱折腾技术的普通人</li><li class="mt-2">粤ICP备2023148789号</li></ul><div class="hb-footer-socials d-flex mb-2 justify-content-center flex-wrap"><a class="hb-social p-2" href="mailto:andywuwu0728@gmail.com" target="_blank" rel="nofollow me" title="Email"><svg aria-hidden="true" class="bi bi-envelope-fillbi bi-envelope-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"></path></svg></a><a class="hb-social p-2" href="https://github.com/Andywugh" target="_blank" rel="nofollow me" title="GitHub"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:%!s(bool=true)" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="hb-social p-2" href="/index.xml" target="_blank" rel="nofollow me" title="RSS"><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"></path></svg></a><a class="hb-social p-2" href="https://www.zhihu.com/people/Andywuwu" target="_blank" rel="nofollow me" title="知乎"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:#056de8" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>Zhihu</title><path d="M5.721.0C2.251.0.0 2.25.0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75.0 18.281.0zm1.964 4.078c-.271.73-.5 1.434-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58.104 58.104.0 01-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.223 9.223.0 01-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125zM13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"></path></svg></a></div></div></div></div></footer><script src="/js/hb.98fbef26aee1dc93ac9816012aa28e7b0359d35ac4173e8360f2b9c832d115d0.js" integrity="sha256-mPvvJq7h3JOsmBYBKqKOewNZ01rEFz6DYPK5yDLRFdA=" defer=""></script><script src="/js/search.f15ba0f94f9841dce207039844bae7bc359e18bf2fd83b8904ceea02ed5ba1ee.js" defer=""></script><script>"serviceWorker"in navigator&&window.addEventListener("DOMContentLoaded",function(){navigator.serviceWorker.register("/sw.js")})</script></body></html>