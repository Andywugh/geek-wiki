<!DOCTYPE html><html data-bs-theme="light" itemscope="" itemtype="http://schema.org/WebPage" lang="zh-hans"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="manifest" href="https://www.hotmindshare.com/manifest.webmanifest"/><link rel="alternate" type="application/rss+xml" href="https://www.hotmindshare.com/series/rocketmq/index.xml"/><meta name="description" content="RocketMQ"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_16x16_resize_box_3.png" sizes="16x16" type="image/png"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_32x32_resize_box_3.png" sizes="32x32" type="image/png"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_150x150_resize_box_3.png" sizes="150x150" type="image/png"/><link rel="apple-touch-icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_180x180_resize_box_3.png" sizes="180x180" type="image/png"/><link rel="icon" href="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_192x192_resize_box_3.png" sizes="192x192" type="image/png"/><link rel="mask-icon" href="/mask-icon.svg" color="#000000"/><meta property="og:title" content="RocketMQ"/><meta property="og:description" content="ä¸€ä¸ªåªçˆ±æŠ˜è…¾æŠ€æœ¯çš„æ™®é€šäºº"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.hotmindshare.com/series/rocketmq/"/><meta itemprop="name" content="RocketMQ"/><meta itemprop="description" content="ä¸€ä¸ªåªçˆ±æŠ˜è…¾æŠ€æœ¯çš„æ™®é€šäºº"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="RocketMQ"/><meta name="twitter:description" content="ä¸€ä¸ªåªçˆ±æŠ˜è…¾æŠ€æœ¯çš„æ™®é€šäºº"/><title>RocketMQ - 3/3 - ä¸“æ  - ç¨‹åºå‘˜å®‰ä»”</title>
<link href="/css/hb.3c67f855ccf80f01a3923f0fd3bd3203f1b4e2f740e3ce444e0ccab10e418d07.css" rel="stylesheet"/><script src="/js/init.577d4e90bff5601d5756fcf799b0e53568bf56cea3b80fe43f66c9d365e8100c.js" integrity="sha256-V31OkL/1YB1XVvz3mbDlNWi/Vs6juA/kP2bJ02XoEAw="></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?1cbf85f7bc76266af7bdac71374879bf",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel="stylesheet" href="/css/search.ee67fb063f2e4be8eff1be9d9806279c3c3d43570b6266c759281faac3804b11.css"/></head><body><noscript><div class="alert alert-danger text-center rounded-0" role=alert><svg aria-hidden="true" class="bi bi-exclamation-square-fillbi bi-exclamation-square-fill hi-svg-inline me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm6 4c.535.0.954.462.9.995l-.35 3.507a.552.552.0 01-1.1.0L7.1 4.995A.905.905.0 018 4m.002 6a1 1 0 110 2 1 1 0 010-2"/></svg>ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ JavaScriptã€‚</div></noscript><header class="hb-header"><nav class="hb-header-nav navbar navbar-expand-lg"><div class="container-fluid"><a class="navbar-brand d-flex align-items-center" href="/"><img src="https://www.hotmindshare.com/images/logo_hu3f5eb531558986e612421c7146e04118_941594_0x64_resize_box_3.png" alt="Logo" width="64" height="64" class="hb-header-logo d-inline-block align-text-top me-2"/>ç¨‹åºå‘˜å®‰ä»”</a><div class="d-flex order-5"><div class="search-modal-toggle hb-header-search-form position-relative d-flex ms-lg-1"><button type="button" class="hb-header-search-icon border-0 bg-transparent px-2" aria-label="Toggle search">
<svg aria-hidden="true" class="bi bi-searchbi bi-search hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1.007 1.007.0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"></path></svg></button>
<input class="form-control rounded-5 d-none d-lg-block ms-lg-1" id="hb-header-search-input" placeholder="æœç´¢"/>
<span class="hb-header-search-keys position-absolute d-none d-lg-block"><kbd>CTRL</kbd>
<kbd>K</kbd></span></div><button class="navbar-toggler border-0 shadow-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#hb-header-content" aria-controls="hb-header-content" aria-label="Toggle navigation"><svg aria-hidden="true" class="bi bi-three-dotsbi bi-three-dots hi-svg-inline" fill="currentcolor" height="1.25em" viewBox="0 0 16 16" width="1.25em" xmlns="http://www.w3.org/2000/svg"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3"></path></svg></button></div><div class="offcanvas offcanvas-lg offcanvas-end" tabindex="-1" id="hb-header-content" aria-labelledby="hb-header-content-label"><div class="offcanvas-header"><h5 class="offcanvas-title" id="hb-header-content-label">ç¨‹åºå‘˜å®‰ä»”</h5><button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button></div><div class="offcanvas-body"><ul class="hb-header-menus navbar-nav flex-row flex-wrap"><li class="hb-header-menu nav-item col-6 col-lg-auto"><a class="nav-link" href="https://www.hotmindshare.com/docs/"><svg aria-hidden="true" class="bi bi-bookbi bi-book hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5.0 000 2.5v11a.5.5.0 00.707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5.0 00.78.0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5.0 0016 13.5v-11a.5.5.0 00-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"></path></svg>æŠ€æœ¯æ•™ç¨‹</a></li><li class="hb-header-menu dropdown nav-item col-12 col-lg-auto"><a class="nav-link pe-0 d-inline-flex align-items-center" href="/interview/"><svg aria-hidden="true" class="bi bi-journal-bookmark-fillbi bi-journal-bookmark-fill hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6 1h6v7a.5.5.0 01-.757.429L9 7.083 6.757 8.43A.5.5.0 016 8z"></path><path d="M3 0h10a2 2 0 012 2v12a2 2 0 01-2 2H3a2 2 0 01-2-2v-1h1v1a1 1 0 001 1h10a1 1 0 001-1V2a1 1 0 00-1-1H3A1 1 0 002 2v1H1V2a2 2 0 012-2"></path><path d="M1 5v-.5a.5.5.0 011 0V5h.5a.5.5.0 010 1h-2a.5.5.0 010-1zm0 3v-.5a.5.5.0 011 0V8h.5a.5.5.0 010 1h-2a.5.5.0 010-1zm0 3v-.5a.5.5.0 011 0v.5h.5a.5.5.0 010 1h-2a.5.5.0 010-1z"></path></svg>ğŸ”¥é¢è¯•æŒ‡å—</a>
<a class="nav-link ps-0 d-inline-flex" href="#" id="header-menu-interview" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span class="visually-hidden">Toggle Dropdown</span><svg aria-hidden="true" class="bi bi-chevron-compact-downbi bi-chevron-compact-down hi-svg-inline" fill="currentcolor" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1.553 6.776a.5.5.0 01.67-.223L8 9.44l5.776-2.888a.5.5.0 11.448.894l-6 3a.5.5.0 01-.448.0l-6-3a.5.5.0 01-.223-.67z"></path></svg></a><ul class="hb-header-submenus dropdown-menu" aria-labelledby="header-menu-interview" data-bs-popper="none"><li class="column-span-all"><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/interview/v4/"><div class="dropdown-item-content"><div class="dropdown-item-title">ç»¼åˆé¢è¯•æŒ‡å—ç¬¬4ç‰ˆ</div></div></a></li></ul></li><li class="hb-header-menu dropdown nav-item col-12 col-lg-auto"><a class="nav-link pe-0 d-inline-flex align-items-center" href="/blog/"><svg aria-hidden="true" class="hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M192 32c0 17.7 14.3 32 32 32 123.7.0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1.0 224 0c-17.7.0-32 14.3-32 32zm0 96c0 17.7 14.3 32 32 32 70.7.0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7.0-32 14.3-32 32zM96 144c0-26.5-21.5-48-48-48S0 117.5.0 144V368c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144H128v96h16c26.5.0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48V144z"></path></svg>åšå®¢</a>
<a class="nav-link ps-0 d-inline-flex" href="#" id="header-menu-blog" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span class="visually-hidden">Toggle Dropdown</span><svg aria-hidden="true" class="bi bi-chevron-compact-downbi bi-chevron-compact-down hi-svg-inline" fill="currentcolor" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1.553 6.776a.5.5.0 01.67-.223L8 9.44l5.776-2.888a.5.5.0 11.448.894l-6 3a.5.5.0 01-.448.0l-6-3a.5.5.0 01-.223-.67z"></path></svg></a><ul class="hb-header-submenus dropdown-menu" aria-labelledby="header-menu-blog" data-bs-popper="none"><li><a class="hb-header-submenu dropdown-item d-flex align-items-center active" href="https://www.hotmindshare.com/series/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-columnsbi bi-columns hi-svg-inline" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2a1 1 0 011-1h14a1 1 0 011 1v12a1 1 0 01-1 1H1a1 1 0 01-1-1zm8.5.0v8H15V2zm0 9v3H15v-3zm-1-9H1v3h6.5zM1 14h6.5V6H1z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">ä¸“æ </div><p class="dropdown-item-desc mb-0 text-wrap">æ‰€æœ‰ä¸“æ ã€‚</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/authors/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-pencilbi bi-pencil hi-svg-inline" fill="currentcolor" height="2em" style="color:#0f5e97" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M12.146.146a.5.5.0 01.708.0l3 3a.5.5.0 010 .708l-10 10a.5.5.0 01-.168.11l-5 2a.5.5.0 01-.65-.65l2-5a.5.5.0 01.11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5.0 01.5.5v.5h.5a.5.5.0 01.5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5.0 015 12.5V12h-.5a.5.5.0 01-.5-.5V11h-.5a.5.5.0 01-.468-.325z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">ä½œè€…</div><p class="dropdown-item-desc mb-0 text-wrap">ä½œè€…åˆ—è¡¨ã€‚</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/categories/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-folderbi bi-folder hi-svg-inline" fill="currentcolor" height="2em" style="color:orange" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M.54 3.87.5 3a2 2 0 012-2h3.672a2 2 0 011.414.586l.828.828A2 2 0 009.828 3h3.982a2 2 0 011.992 2.181l-.637 7A2 2 0 0113.174 14H2.826A2 2 0 01.835 12.181l-.637-7a1.99 1.99.0 01.342-1.31zM2.19 4a1 1 0 00-.996 1.09l.637 7a1 1 0 00.995.91h10.348a1 1 0 00.995-.91l.637-7A1 1 0 0013.81 4H2.19zm4.69-1.707A1 1 0 006.172 2H2.5a1 1 0 00-1 .981l.006.139C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">åˆ†ç±»</div><p class="dropdown-item-desc mb-0 text-wrap">æ‰€æœ‰åˆ†ç±»ã€‚</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/archives/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-archivebi bi-archive hi-svg-inline" fill="currentcolor" height="2em" style="color:384955" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1v7.5A2.5 2.5.0 0112.5 15h-9A2.5 2.5.0 011 12.5V5A1 1 0 010 4zm2 3v7.5A1.5 1.5.0 003.5 14h9a1.5 1.5.0 001.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5.0 01.5-.5h5a.5.5.0 010 1h-5A.5.5.0 015 7.5"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">å½’æ¡£</div><p class="dropdown-item-desc mb-0 text-wrap">æ–‡ç« å½’æ¡£ã€‚</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href="https://www.hotmindshare.com/tags/"><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-tagsbi bi-tags hi-svg-inline" fill="currentcolor" height="2em" style="color:green" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M3 2v4.586l7 7L14.586 9l-7-7zM2 2a1 1 0 011-1h4.586a1 1 0 01.707.293l7 7a1 1 0 010 1.414l-4.586 4.586a1 1 0 01-1.414.0l-7-7A1 1 0 012 6.586z"></path><path d="M5.5 5a.5.5.0 110-1 .5.5.0 010 1m0 1a1.5 1.5.0 100-3 1.5 1.5.0 000 3M1 7.086a1 1 0 00.293.707L8.75 15.25l-.043.043a1 1 0 01-1.414.0l-7-7A1 1 0 010 7.586V3a1 1 0 011-1z"></path></svg></div><div class="dropdown-item-content"><div class="dropdown-item-title mb-1">æ ‡ç­¾</div><p class="dropdown-item-desc mb-0 text-wrap">æ‰€æœ‰æ ‡ç­¾ã€‚</p></div></a></li></ul></li></ul><ul class="hb-header-panel navbar-nav flex-row flex-wrap"><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><hr class="d-lg-none my-2 text-body-50"/></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="mailto:andywuwu0728@gmail.com" target="_blank" rel="nofollow me" title="Email"><svg aria-hidden="true" class="bi bi-envelope-fillbi bi-envelope-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"></path></svg><span class="hb-social-text d-lg-none ms-1">Email</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="https://github.com/Andywugh" target="_blank" rel="nofollow me" title="GitHub"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="hb-social-text d-lg-none ms-1">GitHub</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="/index.xml" target="_blank" rel="nofollow me" title="RSS"><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"></path></svg><span class="hb-social-text d-lg-none ms-1">RSS</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href="https://www.zhihu.com/people/Andywuwu" target="_blank" rel="nofollow me" title="çŸ¥ä¹"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Zhihu</title><path d="M5.721.0C2.251.0.0 2.25.0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75.0 18.281.0zm1.964 4.078c-.271.73-.5 1.434-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58.104 58.104.0 01-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.223 9.223.0 01-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125zM13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"></path></svg><span class="hb-social-text d-lg-none ms-1">çŸ¥ä¹</span></a></li><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><div class="vr d-none d-lg-flex h-100 mx-lg-2 text-body"></div><hr class="d-lg-none my-2 text-body-50"/></li><li class="theme-toggle nav-item dropdown col-6 col-lg-auto d-flex flex-column justify-content-center"><button class="btn btn-link btn-theme-toggle nav-link py-2 px-0 px-lg-2 d-flex justify-content-start justify-content-lg-center align-items-center" data-style="switch" aria-expanded="false" title="ä¸»é¢˜">
<svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1 theme-toggle-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1zm0 1A8 8 0 118 0a8 8 0 010 16"></path></svg><span class="d-lg-none ms-1 theme-name">ä¸»é¢˜</span></button><ul class="theme-toggle-menu dropdown-menu dropdown-menu-end"><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name="è‡ªåŠ¨" data-bs-theme-value="auto">
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1zm0 1A8 8 0 118 0a8 8 0 010 16"></path></svg></span>è‡ªåŠ¨</button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name="æš—è‰²" data-bs-theme-value="dark">
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-moon-starsbi bi-moon-stars hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278M4.858 1.311A7.269 7.269.0 001.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316.0 005.205-2.162c-.337.042-.68.063-1.029.063-4.61.0-8.343-3.714-8.343-8.29.0-1.167.242-2.278.681-3.286z"></path><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></svg></span>æš—è‰²</button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name="äº®è‰²" data-bs-theme-value="light">
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-brightness-highbi bi-brightness-high hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 11a3 3 0 110-6 3 3 0 010 6m0 1a4 4 0 100-8 4 4 0 000 8M8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0m0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13m8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5M3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8m10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0m-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707M4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"></path></svg></span>äº®è‰²</button></li></ul></li></ul></div></div></div></nav></header><div class="hb-main container"><div class="hb-blog-main-container"><div class="hb-blog-main"><div class="container-fluid px-0 mb-4"><nav aria-label="breadcrumb"><ol class="hb-breadcrumb breadcrumb"><li class="breadcrumb-item"><a href="/" title="ç¨‹åºå‘˜å®‰ä»”çš„æŠ€æœ¯æ–‡æ¡£/åšå®¢">ä¸»é¡µ</a></li><li class="breadcrumb-item"><a href="/series/" title="ä¸“æ ">ä¸“æ </a></li><li class="breadcrumb-item active" aria-current="page"><a href="/series/rocketmq/" title="RocketMQ">RocketMQ</a></li></ol></nav></div><div class="hb-blog-term-profile hb-module d-flex flex-column align-items-center"><h1 class="text-center h4 mb-3 mt-2"><a class="text-decoration-none" href="/series/rocketmq/">RocketMQ</a></h1><ul class="nav justify-content-center mt-auto mb-0"><li class="nav-item d-flex flex-column justify-content-center align-items-center my-2 mx-3"><span class="mb-1 fw-bold btn btn-secondary rounded">36</span>
<span class="text-body-secondary">æ–‡ç« </span></li><li class="nav-item d-flex flex-column justify-content-center align-items-center my-2 mx-3"><span class="mb-1 fw-bold btn btn-secondary rounded">1</span>
<span class="text-body-secondary">æ¿å—</span></li><li class="nav-item d-flex flex-column justify-content-center align-items-center my-2 mx-3"><span class="mb-1 fw-bold btn btn-secondary rounded">1</span>
<span class="text-body-secondary">ç±»å‹</span></li></ul></div><div class="hb-terms-posts row row-cols-1 row-cols-md-2"><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">7 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/18/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åå…«ã€æºç ç ”ç©¶RocketMQä¸»ä»åŒæ­¥æœºåˆ¶(HA)" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åå…«ã€æºç ç ”ç©¶RocketMQä¸»ä»åŒæ­¥æœºåˆ¶(HA)" href="/docs/mq/rocketmq-advanced/18/">åå…«ã€æºç ç ”ç©¶RocketMQä¸»ä»åŒæ­¥æœºåˆ¶(HA)</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">å…³äºä¸»ä»åŒæ­¥æœ€æ–°ç†è§£ï¼šRocketMQ ä¸»ä»åŒæ­¥è‹¥å¹²é—®é¢˜ç­”ç–‘
HAä¸»ä»åŒæ­¥çš„æ ¸å¿ƒç±»å›¾å¦‚å›¾æ‰€ç¤ºï¼š
åˆå§‹RocketMQ HA HAServiceï¼šä¸»ä»åŒæ­¥æ ¸å¿ƒå®ç°ç±»ã€‚
AtomicInteger connectionCountï¼šMasterç»´æŠ¤çš„è¿æ¥æ•°ã€‚ï¼ˆSlaveçš„ä¸ªæ•°ï¼‰ã€‚ List&lt; HAConnection&gt; connectionListï¼šå…·ä½“è¿æ¥ä¿¡æ¯ã€‚ AcceptSocketService acceptSocketServiceï¼šæœåŠ¡ç«¯æ¥æ”¶è¿æ¥çº¿ç¨‹å®ç°ç±»ã€‚ DefaultMessageStore defaultMessageStoreï¼šBrokerå­˜å‚¨å®ç°ã€‚ WaitNotifyObject waitNotifyObjectï¼šåŒæ­¥ç­‰å¾…å®ç°ã€‚ AtomicLong push2SlaveMaxOffsetï¼šè¯¥Masteræ‰€æœ‰Slaveä¸­åŒæ­¥æœ€å¤§çš„åç§»é‡ã€‚ GroupTransferService groupTransferServiceï¼šåˆ¤æ–­ä¸»ä»åŒæ­¥å¤åˆ¶æ˜¯å¦å®Œæˆã€‚ HAClient haClientï¼šHAå®¢æˆ·ç«¯å®ç°ï¼ŒSlaveç«¯ç½‘ç»œçš„å®ç°ç±»ã€‚ HAConnectionï¼šHA Master-Slave ç½‘ç»œè¿æ¥å¯¹è±¡ã€‚
private final HAService haServiceï¼šå…³è”çš„AServiceå®ç°ç±»ã€‚ SocketChannel socketChannelï¼šç½‘ç»œé€šé“ã€‚ String clientAddrï¼šå®¢æˆ·ç«¯åœ°å€ã€‚ WriteSocketService writeSocketServiceï¼šHAConnectionç½‘ç»œå†™å°è£…ã€‚ ReadSocketService readSocketServiceï¼šHAConnectionç½‘ç»œå†™å°è£…ã€‚ RocketMQ HAæœºåˆ¶å¤§ä½“å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚
Masterå¯åŠ¨å¹¶ç›‘å¬Slaveçš„è¿æ¥è¯·æ±‚ã€‚ Slaveå¯åŠ¨ï¼Œä¸Masterå»ºç«‹é“¾æ¥ã€‚ Slaveå‘é€å¾…æ‹‰å–åç§»é‡å¾…Masterè¿”å›æ•°æ®ï¼ŒæŒç»­è¯¥è¿‡ç¨‹ã€‚ 2ã€HAServiceå®ç°åŸç†å‰–æ å› åˆæ¬¡è®¿é—®ï¼Œä¸ºé˜²æ­¢çˆ¬è™«å’Œäººæœºè¯†åˆ«ï¼Œè¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼Œå›å¤:â€˜éªŒè¯ç â€˜è·å–éªŒè¯ç æ¥è§£é”å…¨æ–‡ è§£é”å†…å®¹ 2.1 Masterå¯åŠ¨æµç¨‹ï¼ˆHAServiceï¼‰ 1public void start() throws Exception { 2 this.acceptSocketService.beginAccept(); 3 this.acceptSocketService.start(); 4 this.groupTransferService.start(); 5 this.haClient.start(); 6public void start() throws Exception { 7 this.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/18/">é˜…è¯»æ›´å¤šå…³äºåå…«ã€æºç ç ”ç©¶RocketMQä¸»ä»åŒæ­¥æœºåˆ¶(HA)çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">11 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/12/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åäºŒã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸Šç¯‡â€”â€“æ¶ˆæ¯æ¶ˆè´¹æœåŠ¡ç«¯è¿‡æ»¤ä¸TAGæ¨¡å¼è¿‡æ»¤å®ç°" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åäºŒã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸Šç¯‡â€”â€“æ¶ˆæ¯æ¶ˆè´¹æœåŠ¡ç«¯è¿‡æ»¤ä¸TAGæ¨¡å¼è¿‡æ»¤å®ç°" href="/docs/mq/rocketmq-advanced/12/">åäºŒã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸Šç¯‡â€”â€“æ¶ˆæ¯æ¶ˆè´¹æœåŠ¡ç«¯è¿‡æ»¤ä¸TAGæ¨¡å¼è¿‡æ»¤å®ç°</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">1ã€æ¶ˆæ¯æ¶ˆè´¹è¿‡æ»¤æœºåˆ¶ 1.1 æ ¹æ® tagcode è¿‡æ»¤ 1.2 é«˜çº§è¿‡æ»¤ å› åˆæ¬¡è®¿é—®ï¼Œä¸ºé˜²æ­¢çˆ¬è™«å’Œäººæœºè¯†åˆ«ï¼Œè¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼Œå›å¤:â€˜éªŒè¯ç â€˜è·å–éªŒè¯ç æ¥è§£é”å…¨æ–‡ è§£é”å†…å®¹ ä¸Šè¿°èµ„æºæ¥æºäº RocketMQ å®˜æ–¹æ–‡æ¡£ã€‚
é€šè¿‡å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥çŸ¥é“ï¼Œæ¶ˆæ¯çš„è¿‡æ»¤æœºåˆ¶ä¸æœåŠ¡ç«¯æ¯æ¯ç›¸å…³ï¼Œæ›´ç»†ä¸€ç‚¹çš„è®²ï¼Œä¸æ‹‰å–æ¶ˆæ¯å®ç°è¿‡ç¨‹è„±ç¦»ä¸äº†å…³ç³»ï¼Œäº‹å®ä¸Šä¹Ÿçš„ç¡®å¦‚æ­¤ï¼ŒMessageFilter çš„ä½¿ç”¨è€…ä¹Ÿå°±æ˜¯ DefaultMessageStore#getMessage æ–¹æ³•ï¼Œä¸ºäº†å¼„æ¸…æ¥šæ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ MessageFilter æ¥å£ï¼Œç„¶åè¯¦ç»†å†æµè§ˆä¸€ä¸‹æ¶ˆæ¯æ‹‰å–å®ç°ç»†èŠ‚ã€‚
MessageFilter æ¥å£ç±»ï¼š
1boolean isMatchedByConsumeQueue(final Long tagsCode, final ConsumeQueueExt.CqExtUnit cqExtUnit); isMatchedByConsumeQueue ã€isMatchedByCommitLog çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä»å­—é¢ä¸Šç†è§£ï¼Œä¸€ä¸ªè¿‡æ»¤åŸºäº ConsumeQueueï¼Œä¸€ä¸ªåŸºäºCommitLog è¿‡æ»¤ï¼Œä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·å‘¢ï¼Ÿè¯·å¸¦ç€ä¸Šé¢çš„é—®é¢˜å¼€å§‹åé¢çš„æ¢ç´¢ã€‚
2ã€ DefaultMessageStore#getMessage 1public GetMessageResult getMessage(final String group, final String topic, final int queueId, final long offset, 2 final int maxMsgNums, 3 final MessageFilter messageFilter) { // @1 4 if (this.shutdown) { 5 log.warn(&#34;message store has shutdown, so getMessage is forbidden&#34;); 6 return null; 7 } 8 if (!</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/12/">é˜…è¯»æ›´å¤šå…³äºåäºŒã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸Šç¯‡â€”â€“æ¶ˆæ¯æ¶ˆè´¹æœåŠ¡ç«¯è¿‡æ»¤ä¸TAGæ¨¡å¼è¿‡æ»¤å®ç°çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">2 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/19/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åä¹ã€RocketMQ ä¸»ä»åŒæ­¥è¯»å†™åˆ†ç¦»æœºåˆ¶" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åä¹ã€RocketMQ ä¸»ä»åŒæ­¥è¯»å†™åˆ†ç¦»æœºåˆ¶" href="/docs/mq/rocketmq-advanced/19/">åä¹ã€RocketMQ ä¸»ä»åŒæ­¥è¯»å†™åˆ†ç¦»æœºåˆ¶</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">å…³äºä¸»ä»åŒæ­¥æœ€æ–°ç†è§£ï¼šRocketMQ ä¸»ä»åŒæ­¥è‹¥å¹²é—®é¢˜ç­”ç–‘
RocketMQåœ¨æ¶ˆæ¯æ‹‰å–æ—¶æ˜¯å¦‚ä½•æ ¹æ®æ¶ˆæ¯æ¶ˆè´¹é˜Ÿåˆ—MessageQueueæ¥é€‰æ‹©Brokerçš„å‘¢ï¼Ÿæ¶ˆæ¯æ¶ˆè´¹é˜Ÿåˆ—å¦‚å›¾æ‰€ç¤ºï¼š
RocketMQæ ¹æ®MessageQueueæŸ¥æ‰¾Brokeråœ°å€çš„å”¯ä¸€ä¾æ®ä¾¿æ˜¯brokerNameï¼Œä»RocketMQçš„Brokerç»„ç»‡å®ç°æ¥çœ‹ï¼ŒåŒä¸€ç»„Broker(M-S)æœåŠ¡å™¨ï¼Œå…¶brokerNameç›¸åŒï¼Œä¸»æœåŠ¡å™¨çš„brokerIdä¸º0ï¼Œä»æœåŠ¡å™¨çš„brokerIdå¤§äº0ï¼Œé‚£RocketMQæ ¹æ®brokerNameå¦‚ä½•å®šä½åˆ°å“ªä¸€å°Brokerä¸Šæ¥å‘¢ï¼Ÿ
PullAPIWrapper#pullKernelImpl
1FindBrokerResult findBrokerResult = 2 this.mQClientFactory.findBrokerAddressInSubscribe(mq.getBrokerName(), 3 this.recalculatePullFromWhichNode(mq), false); RocketMQçš„MQClientInstanceç±»æä¾›äº†æ ¹æ®brokerNameã€brokerIdæŸ¥æ‰¾Brokeråœ°å€çš„æ–¹æ³•ï¼Œè¿”å›å€¼å¦‚å›¾ï¼š
MQClientInstance#findBrokerAddressInSubscribe
1public FindBrokerResult findBrokerAddressInSubscribe( 2 final String brokerName, 3 final long brokerId, 4 final boolean onlyThisBroker 5 ) { 6 String brokerAddr = null; 7 boolean slave = false; 8 boolean found = false; 9 HashMap&lt;Long/* brokerId */, String/* address */&gt; map = this.brokerAddrTable.get(brokerName); 10 if (map != null &amp;&amp; !map.isEmpty()) { 11 brokerAddr = map.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/19/">é˜…è¯»æ›´å¤šå…³äºåä¹ã€RocketMQ ä¸»ä»åŒæ­¥è¯»å†™åˆ†ç¦»æœºåˆ¶çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">6 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/16/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åå…­ã€RocketMQæºç åˆ†æé¡ºåºæ¶ˆæ¯æ¶ˆè´¹å®ç°åŸç†" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åå…­ã€RocketMQæºç åˆ†æé¡ºåºæ¶ˆæ¯æ¶ˆè´¹å®ç°åŸç†" href="/docs/mq/rocketmq-advanced/16/">åå…­ã€RocketMQæºç åˆ†æé¡ºåºæ¶ˆæ¯æ¶ˆè´¹å®ç°åŸç†</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">æœ¬èŠ‚ç›®å½• 1ã€ æ¶ˆæ¯é˜Ÿåˆ—è´Ÿè½½ï¼›
2ã€ æ¶ˆæ¯æ‹‰å–ï¼›
3ã€ æ¶ˆæ¯é¡ºåºæ¶ˆæ¯æ¶ˆè´¹ï¼›
3.1æ ¸å¿ƒå±æ€§ä¸æ„é€ å‡½æ•° 3.2 startæ–¹æ³• 3.3 submitConsumeRequest 3.4 ConsumeMessageOrderlyService#ConsumeRequest 3.4 æ¶ˆæ¯é˜Ÿåˆ—é”å®ç° æ‰€è°“é¡ºåºæ¶ˆè´¹ï¼Œrocketmq æ”¯æŒåŒä¸€æ¶ˆè´¹é˜Ÿåˆ—ä¸Šçš„æ¶ˆæ¯é¡ºåºæ¶ˆè´¹ã€‚
æ¶ˆæ¯æ¶ˆè´¹æ¶‰åŠ3ä¸ªç‚¹ï¼š
1ã€ æ¶ˆæ¯é˜Ÿåˆ—é‡æ–°è´Ÿè½½ï¼›
2ã€ æ¶ˆæ¯æ‹‰å–ï¼›
3ã€ æ¶ˆæ¯æ¶ˆè´¹ï¼›
æŒ‰ç…§æ¶ˆæ¯æ¶ˆè´¹æ­¥éª¤æ¥æ­å¼€ RocketMQ é¡ºåºæ¶ˆæ¯æ¶ˆè´¹å®ç°åŸç†ã€‚
1ã€æ¶ˆæ¯é˜Ÿåˆ—è´Ÿè½½ RocketMQ åœ¨åŒä¸€ä¸ª JVM è¿›ç¨‹æ‹¥æœ‰ä¸€ä¸ª clientConfigId(å®¢æˆ·ç«¯ID)ï¼Œè¯¥JVMè¿›ç¨‹ä¸­ä¸åŒçš„æ¶ˆæ¯æ¶ˆè´¹ç»„çš„æ¶ˆæ¯å®¢æˆ·ç«¯IDç›¸åŒï¼Œå› ä¸ºåœ¨JVMè¿›ç¨‹ä¸­å¯¹äºæ¯ä¸€ä¸ª ClientConfig åªä¼šå®ä¾‹åŒ–ä¸€ä¸ª MQClientInstanceã€‚æ¶ˆæ¯æ¶ˆè´¹çš„ç¬¬ä¸€ä¸ªæ­¥éª¤æ˜¯é¦–å…ˆè¦ä¸ºæ¶ˆè´¹ç»„å†…çš„æ‰€æœ‰æ¶ˆæ¯è€…åˆ†é…æ¶ˆæ¯æ¶ˆè´¹é˜Ÿåˆ—ã€‚RocetMQ ä¸­é€šè¿‡RebalanceServiceçº¿ç¨‹å®ç°æ¶ˆè´¹é˜Ÿåˆ—è´Ÿè½½ã€‚
1RebalanceImpl#updateProcessQueueTableInRebalance 2List&lt;PullRequest&gt; pullRequestList = new ArrayList&lt;PullRequest&gt;(); 3for (MessageQueue mq : mqSet) { 4 if (!this.processQueueTable.containsKey(mq)) { 5 if (isOrder &amp;&amp; !this.lock(mq)) { // @1 6 log.warn(&#34;doRebalance, {}, add a new mq failed, {}, because lock failed&#34;, consumerGroup, mq); 7 continue; 8 } 9 this.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/16/">é˜…è¯»æ›´å¤šå…³äºåå…­ã€RocketMQæºç åˆ†æé¡ºåºæ¶ˆæ¯æ¶ˆè´¹å®ç°åŸç†çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">2 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/17/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åä¸ƒã€RocketMQæºç åˆ†ææ–‡ä»¶æ¸…é™¤æœºåˆ¶" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åä¸ƒã€RocketMQæºç åˆ†ææ–‡ä»¶æ¸…é™¤æœºåˆ¶" href="/docs/mq/rocketmq-advanced/17/">åä¸ƒã€RocketMQæºç åˆ†ææ–‡ä»¶æ¸…é™¤æœºåˆ¶</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">ç”±äºRocketMQæ“ä½œCommitLogã€ConsumeQueueæ–‡ä»¶ï¼Œéƒ½æ˜¯åŸºäºå†…å­˜æ˜ å°„æ–¹æ³•å¹¶åœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šåŠ è½½commitlogã€ConsumeQueueç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¸ºäº†é¿å…å†…å­˜ä¸ç£ç›˜çš„æµªè´¹ï¼Œä¸å¯èƒ½å°†æ¶ˆæ¯æ°¸ä¹…å­˜å‚¨åœ¨æ¶ˆæ¯æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥éœ€è¦ä¸€ç§æœºåˆ¶æ¥åˆ é™¤å·²è¿‡æœŸçš„æ–‡ä»¶ã€‚
RocketMQé¡ºåºå†™Commitlogã€ConsumeQueueæ–‡ä»¶ï¼Œæ‰€æœ‰å†™æ“ä½œå…¨éƒ¨è½åœ¨æœ€åä¸€ä¸ªCommitLogæˆ–ConsumeQueueæ–‡ä»¶ä¸Šï¼Œä¹‹å‰çš„æ–‡ä»¶åœ¨ä¸‹ä¸€ä¸ªæ–‡ä»¶åˆ›å»ºåï¼Œå°†ä¸ä¼šå†è¢«æ›´æ–°ã€‚
RocketMQæ¸…é™¤è¿‡æœŸæ–‡ä»¶çš„æ–¹æ³•æ˜¯ï¼šå¦‚æœéå½“å‰å†™æ–‡ä»¶åœ¨ä¸€å®šæ—¶é—´é—´éš”å†…æ²¡æœ‰å†æ¬¡è¢«æ›´æ–°ï¼Œåˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ–‡ä»¶ï¼Œå¯ä»¥è¢«åˆ é™¤ï¼ŒRocketMQä¸ä¼šç®¡è¿™ä¸ªè¿™ä¸ªæ–‡ä»¶ä¸Šçš„æ¶ˆæ¯æ˜¯å¦è¢«å…¨éƒ¨æ¶ˆè´¹ã€‚é»˜è®¤æ¯ä¸ªæ–‡ä»¶çš„è¿‡æœŸæ—¶é—´ä¸º72å°æ—¶ã€‚é€šè¿‡åœ¨Brokeré…ç½®æ–‡ä»¶ä¸­è®¾ç½®fileReservedTimeæ¥æ”¹å˜è¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºå°æ—¶ã€‚æ¥ä¸‹æ¥è¯¦ç»†åˆ†æRocketMQæ˜¯å¦‚ä½•è®¾è®¡ä¸å®ç°ä¸Šè¿°æœºåˆ¶çš„ã€‚
DefaultMessageStore#addScheduleTask:
1this.scheduledExecutorService.scheduleAtFixedRate(new Runnable() { 2 @Override 3 public void run() { 4 DefaultMessageStore.this.cleanFilesPeriodically(); 5 } 6 }, 1000 * 60, this.messageStoreConfig.getCleanResourceInterval(), TimeUnit.MILLISECONDS); RocketMQ ä¼šæ¯éš”10sè°ƒåº¦ä¸€æ¬¡cleanFilesPeriodicallyï¼Œå·²æ£€æµ‹æ˜¯å¦éœ€è¦æ¸…é™¤è¿‡æœŸæ–‡ä»¶ã€‚æ‰§è¡Œé¢‘ç‡å¯ä»¥é€šè¿‡è®¾ç½®cleanResourceIntervalï¼Œé»˜è®¤ä¸º10sã€‚
DefaultMessageStore#cleanFilesPeriodically
1private void cleanFilesPeriodically() { 2 this.cleanCommitLogService.run(); 3 this.cleanConsumeQueueService.run(); 4 } ä¸»è¦æ¸…é™¤CommitLogã€ConsumeQueueçš„è¿‡æœŸæ–‡ä»¶ã€‚CommitLog ä¸ ConsumeQueue å¯¹äºè¿‡æœŸæ–‡ä»¶çš„åˆ é™¤ç®—æ³•ã€é€»è¾‘å¤§åŒå°å¼‚ï¼Œæœ¬æ–‡å°†ä»¥ CommitLog è¿‡æœŸæ–‡ä»¶ä¸ºä¾‹æ¥è¯¦ç»†åˆ†æå…¶å®ç°åŸç†ã€‚
DefaultMessageStore$CleanCommitLogService#run
1public void run() { 2 try { 3 this.deleteExpiredFiles(); 4 this.redeleteHangedFile(); 5 } catch (Throwable e) { 6 DefaultMessageStore.log.warn(this.getServiceName() + &#34; service has 7 exception.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/17/">é˜…è¯»æ›´å¤šå…³äºåä¸ƒã€RocketMQæºç åˆ†ææ–‡ä»¶æ¸…é™¤æœºåˆ¶çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">6 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/13/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åä¸‰ã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸‹ç¯‡-FilterServerã€ClassFilteræ¨¡å¼è¯¦è§£" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åä¸‰ã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸‹ç¯‡-FilterServerã€ClassFilteræ¨¡å¼è¯¦è§£" href="/docs/mq/rocketmq-advanced/13/">åä¸‰ã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸‹ç¯‡-FilterServerã€ClassFilteræ¨¡å¼è¯¦è§£</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">ç»§ä¸Šç¯‡æºç åˆ†æäº† Tag è¿‡æ»¤æœºåˆ¶å®ç°åŸç†ï¼Œæœ¬æ–‡ä¸»è¦é˜è¿° RocketMQ SQL92 è¡¨è¾¾å¼ä¸ ClassFilte rè¿‡æ»¤æœºåˆ¶å®ç°ã€‚
1ã€RocketMQ SQL92å®ç°åŸç†åˆ†æ å…¥å£ï¼šPullMessageProcessor#processRequest
1if (!ExpressionType.isTagType(subscriptionData.getExpressionType())) { 2consumerFilterData = ConsumerFilterManager.build( 3 requestHeader.getTopic(), requestHeader.getConsumerGroup(), requestHeader.getSubscription(), 4 requestHeader.getExpressionType(), requestHeader.getSubVersion() 5 ); 6 assert consumerFilterData != null; é¦–å…ˆæ„å»ºConsumeFilterDataæ•°æ®ç»“æ„ï¼š
consumeGroup: æ¶ˆè´¹ç»„ topic ï¼š æ¶ˆæ¯ä¸»é¢˜ expresstion:æ¶ˆæ¯è¿‡æ»¤è¡¨è¾¾å¼ï¼Œä¾‹å¦‚SQL92è¡¨è¾¾å¼ï¼Œæˆ–è¿‡æ»¤ç±»å…¨è·¯å¾„å expresseionType : è¡¨è¾¾å¼ç±»å‹ï¼Œå¯å–å€¼TAGã€SQL92 compiledExpression:ç¼–è¯‘åçš„è¡¨è¾¾å¼å¯¹è±¡ bornTime: ConsumerFilterData å¯¹è±¡åˆ›å»ºåˆ›å»ºæ—¶é—´ deadTime: ConsumerFilterData å¯¹è±¡æ­»äº¡æ—¶é—´ï¼Œé»˜è®¤0ï¼Œè¡¨ç¤ºä¸€ç›´æœ‰æ•ˆã€‚ BloomFilterData bloomFilterData clientVersion:å®¢æˆ·ç«¯ç‰ˆæœ¬ æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆé‡ç‚¹åˆ†æ ConsumerFilterManager#buildæ–¹æ³•ï¼š
1/** 2 * Build consumer filter data.Be care, bloom filter data is not included. 3 * 4 * @return maybe null 5 */ 6 public static ConsumerFilterData build(final String topic, final String consumerGroup, 7 final String expression, final String type, 8 final long clientVersion) { // @1 9 if (ExpressionType.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/13/">é˜…è¯»æ›´å¤šå…³äºåä¸‰ã€RocketMQæºç åˆ†ææ¶ˆæ¯è¿‡æ»¤æœºåˆ¶ä¸‹ç¯‡-FilterServerã€ClassFilteræ¨¡å¼è¯¦è§£çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">3 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/14/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åå››ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ‹‰å–æ‹‰æ¨¡å¼PULL" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åå››ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ‹‰å–æ‹‰æ¨¡å¼PULL" href="/docs/mq/rocketmq-advanced/14/">åå››ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ‹‰å–æ‹‰æ¨¡å¼PULL</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">æœ¬èŠ‚ç›®å½• 1ã€ RocketMQæ¨æ‹‰æ¨¡å¼ç®€ä»‹ï¼›
2ã€ DefaultMQPullConsumeræ ¸å¿ƒå±æ€§ï¼›
3ã€ æ¶ˆæ¯æ¶ˆè´¹è€…å¯åŠ¨æµç¨‹åˆ†æï¼›
1ã€RocketMQ æ¨æ‹‰æ¨¡å¼ç®€ä»‹ æ¶ˆè´¹è€…ä¸æ¶ˆæ¯å­˜å‚¨æ–¹ Brokerä¸€èˆ¬æœ‰ä¸¤ç§é€šä¿¡æœºåˆ¶ï¼šæ¨ï¼ˆPUSHï¼‰ã€æ‹‰(PULL)ã€‚
æ¨æ¨¡å¼ï¼šæ¶ˆæ¯å‘é€è€…å°†æ¶ˆæ¯å‘é€åˆ°Brokerï¼Œç„¶åBrokerä¸»åŠ¨æ¨é€ç»™è®¢é˜…äº†è¯¥æ¶ˆæ¯çš„æ¶ˆè´¹è€…ã€‚ æ‹‰æ¨¡å¼ï¼šæ¶ˆæ¯å‘é€è€…å°†æ¶ˆæ¯å‘é€åˆ°Brokerä¸Šï¼Œç„¶åç”±æ¶ˆæ¯æ¶ˆè´¹è€…è‡ªå‘çš„å‘Brokeræ‹‰å–æ¶ˆæ¯ã€‚ RocketMQ æ¨æ‹‰æœºåˆ¶å®ç°ï¼šä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è®²ï¼ŒRocketMQ å¹¶æ²¡æœ‰å®ç° PUSH æ¨¡å¼ï¼Œè€Œæ˜¯å¯¹æ‹‰æ¨¡å¼è¿›è¡Œä¸€å±‚åŒ…è£…ï¼Œåœ¨æ¶ˆè´¹ç«¯å¼€å¯ä¸€ä¸ªçº¿ç¨‹ PullMessageService å¾ªç¯å‘ Broke ræ‹‰å–æ¶ˆæ¯ï¼Œä¸€æ¬¡æ‹‰å–ä»»åŠ¡ç»“æŸåé©¬ä¸Šåˆå‘èµ·å¦ä¸€æ¬¡æ‹‰å–æ“ä½œï¼Œå®ç°å‡†å®æ—¶è‡ªåŠ¨æ‹‰å–ï¼ŒPUSH æ¨¡å¼çš„å®ç°è¯·å‚è€ƒå¦‚ä¸‹åšæ–‡ï¼š
1ã€ æ¨æ¨¡å¼æ¶ˆæ¯æ‹‰å–æœºåˆ¶ï¼›
2ã€ æ¨æ¨¡å¼æ¶ˆæ¯é˜Ÿåˆ—è´Ÿè½½æœºåˆ¶ï¼›
æœ¬æ–‡é‡ç‚¹åœ¨è®¨è®ºRocketMQæ‹‰æ¨¡å¼DefaultMQPullConsumerå®ç°ã€‚
RocketMQ æ‹‰æ¨¡å¼ï¼ŒRocketMQ æ¶ˆè´¹è€…ä¸è‡ªåŠ¨å‘æ¶ˆæ¯æœåŠ¡å™¨æ‹‰å–æ¶ˆæ¯ï¼Œè€Œæ˜¯å°†æ§åˆ¶æƒç§»äº¤ç»™åº”ç”¨ç¨‹åºï¼ŒRocketMQæ¶ˆè´¹è€…åªæ˜¯æä¾›æ‹‰å–æ¶ˆæ¯APIã€‚
ä¸ºäº†å¯¹RocketMQ æ‹‰æ¨¡å¼æœ‰ä¸€ä¸ªç›´è§‚çš„äº†è§£ï¼Œæˆ‘ä»¬å…ˆå¤§æ¦‚æµè§ˆä¸€ä¸‹ MQPullConsumer æ¥å£ã€‚
ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é™¤äº†å¯åŠ¨ã€å…³é—­ï¼Œæ³¨å†Œæ¶ˆæ¯ç›‘å¬å™¨ï¼Œå…¶ä»–çš„å°±æ˜¯é’ˆå¯¹ MessageQueue æ‹‰å–æ¶ˆæ¯ï¼Œç‰¹åˆ«å€¼å¾—ç•™æ„çš„æ˜¯æ¯ä¸€ä¸ªæ‹‰å– pull æ–¹æ³•ï¼Œéƒ½æ˜¯ç›´æ¥é’ˆå¯¹æ¶ˆæ¯æ¶ˆè´¹é˜Ÿåˆ—ã€‚PUSH æ¨¡å¼å¯ä»¥è¯´åŸºäºè®¢é˜…ä¸å‘å¸ƒæ¨¡å¼ï¼Œè€ŒPULLæ¨¡å¼å¯ä»¥è¯´æ˜¯åŸºäºæ¶ˆæ¯é˜Ÿåˆ—æ¨¡å¼ã€‚
ç‰¹åˆ«è¯´æ˜ï¼šPULLæ¨¡å¼æ ¹æ®ä¸»é¢˜æ³¨å†Œæ¶ˆæ¯ç›‘å¬å™¨ï¼Œè¿™é‡Œçš„æ¶ˆæ¯ç›‘å¬å™¨ï¼Œä¸æ˜¯ç”¨æ¥æ¶ˆæ¯æ¶ˆè´¹çš„ï¼Œè€Œæ˜¯åœ¨è¯¥ä¸»é¢˜çš„é˜Ÿåˆ—è´Ÿè½½å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåšä¸€ä¸‹é€šçŸ¥ã€‚
æˆ‘ä»¬åº”è¯¥å¸¦ç€æˆ‘ä»¬å¯¹ PUSH æ¨¡å¼çš„ç›¸å…³çŸ¥è¯†æ¥è®¤è¯†ä¸€ä¸‹ PULL æ¨¡å¼ï¼Œå¯¹æ¯”å­¦ä¹ .
PUSHæ¨¡å¼ä¸»è¦çŸ¥è¯†ç‚¹ï¼š
æ¶ˆæ¯æ‹‰å–æœºåˆ¶ï¼šPullMessageServerçº¿ç¨‹ æ ¹æ®PullRequestæ‹‰å–ä»»åŠ¡å¾ªç¯æ‹‰å–ã€‚ æ¶ˆæ¯é˜Ÿåˆ—è´Ÿè½½æœºåˆ¶ï¼ŒæŒ‰ç…§æ¶ˆè´¹ç»„ï¼Œå¯¹ä¸»é¢˜ä¸‹çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç»“åˆå½“å‰æ¶ˆè´¹ç»„å†…æ¶ˆè´¹è€…æ•°é‡åŠ¨æ€è´Ÿè½½ã€‚ æŒ‰ç…§ä¸Šé¢APIçš„æè¿°ï¼ŒPULLæ¨¡å¼åº”è¯¥æ— éœ€è€ƒè™‘ä¸Šé¢ä¸¤ä¸ªæƒ…å½¢ï¼Œæˆ‘ä»¬å¸¦ç€ä¸Šè¿°ç–‘é—®ï¼Œå¼€å§‹æˆ‘ä»¬ä»Šå¤©çš„å­¦ä¹ ã€‚
2ã€DefaultMQPullConsumer æ ¸å¿ƒå±æ€§ å› åˆæ¬¡è®¿é—®ï¼Œä¸ºé˜²æ­¢çˆ¬è™«å’Œäººæœºè¯†åˆ«ï¼Œè¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼Œå›å¤:â€˜éªŒè¯ç â€˜è·å–éªŒè¯ç æ¥è§£é”å…¨æ–‡ è§£é”å†…å®¹ 1/** 2 * Do the same thing for the same Group, the application must be set,and 3 * guarantee Globally unique 4 */ 5 private String consumerGroup; 6 /** 7 * Long polling mode, the Consumer connection max suspend time, it is not 8 * recommended to modify 9 */ 10 private long brokerSuspendMaxTimeMillis = 1000 * 20; 11 /** 12 * Long polling mode, the Consumer connection timeout(must greater than 13 * brokerSuspendMaxTimeMillis), it is not recommended to modify 14 */ 15 private long consumerTimeoutMillisWhenSuspend = 1000 * 30; 16 /** 17 * The socket timeout in milliseconds 18 */ 19 private long consumerPullTimeoutMillis = 1000 * 10; 20 /** 21 * Consumption pattern,default is clustering 22 */ 23 private MessageModel messageModel = MessageModel.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/14/">é˜…è¯»æ›´å¤šå…³äºåå››ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ‹‰å–æ‹‰æ¨¡å¼PULLçš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">6 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/15/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åäº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯PULL-é•¿è½®è¯¢æ¨¡å¼" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åäº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯PULL-é•¿è½®è¯¢æ¨¡å¼" href="/docs/mq/rocketmq-advanced/15/">åäº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯PULL-é•¿è½®è¯¢æ¨¡å¼</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">æœ¬èŠ‚ç›®å½• 1ã€ é•¿è½®è¯¢ã€çŸ­è½®è¯¢æ¦‚è¿°ï¼›
2ã€ RocketMQæ‹‰è½®è¯¢æ‹‰å–ä»»åŠ¡åˆ›å»ºï¼›
3ã€ æºç åˆ†æPullRequestHoldServiceçº¿ç¨‹ï¼›
3.1 PullRequestHoldService#suspendPullRequest 3.2 runæ–¹æ³•è¯¦è§£ 4ã€æºç åˆ†æDefaultMessageStore#ReputMessageService
4.1 runæ–¹æ³• 4.2 doReput 1ã€é•¿è½®è¯¢ã€çŸ­è½®è¯¢æ¦‚è¿° æ¶ˆæ¯æ‹‰å–ä¸ºäº†æé«˜ç½‘ç»œæ€§èƒ½ï¼Œåœ¨æ¶ˆæ¯æœåŠ¡ç«¯æ ¹æ®æ‹‰å–åç§»é‡å»ç‰©ç†æ–‡ä»¶æŸ¥æ‰¾æ¶ˆæ¯æ—¶æ²¡æœ‰æ‰¾åˆ°ï¼Œå¹¶ä¸ç«‹å³è¿”å›æ¶ˆæ¯æœªæ‰¾åˆ°ï¼Œè€Œæ˜¯ä¼šå°†è¯¥çº¿ç¨‹æŒ‚èµ·ä¸€æ®µæ—¶é—´ï¼Œç„¶åå†æ¬¡é‡è¯•ï¼Œç›´åˆ°é‡è¯•ã€‚æŒ‚èµ·åˆ†ä¸ºé•¿è½®è¯¢æˆ–çŸ­è½®è¯¢ï¼Œåœ¨broker ç«¯å¯ä»¥é€šè¿‡ longPollingEnable=true æ¥å¼€å¯é•¿è½®è¯¢ã€‚
çŸ­è½®è¯¢ï¼šlongPollingEnable=falseï¼Œç¬¬ä¸€æ¬¡æœªæ‹‰å–åˆ°æ¶ˆæ¯åç­‰å¾… shortPollingTimeMillsæ—¶é—´åå†è¯•ã€‚shortPollingTimeMillsé»˜è®¤ä¸º1Sã€‚
é•¿è½®è¯¢ï¼šlongPollingEnable=trueï¼Œä¼šæ ¹æ®æ¶ˆè´¹è€…ç«¯è®¾ç½®çš„æŒ‚èµ·è¶…æ—¶æ—¶é—´ï¼Œå—DefaultMQPullConsumer çš„brokerSuspendMaxTimeMillisæ§åˆ¶ï¼Œé»˜è®¤20s,ï¼ˆbrokerSuspendMaxTimeMillisï¼‰ï¼Œé•¿è½®è¯¢æœ‰ä¸¤ä¸ªçº¿ç¨‹æ¥ç›¸äº’å®ç°ã€‚
PullRequestHoldServiceï¼šæ¯éš”5sé‡è¯•ä¸€æ¬¡ã€‚ DefaultMessageStore#ReputMessageServiceï¼Œæ¯å½“æœ‰æ¶ˆæ¯åˆ°è¾¾åï¼Œè½¬å‘æ¶ˆæ¯ï¼Œç„¶åè°ƒç”¨PullRequestHoldService çº¿ç¨‹ä¸­çš„æ‹‰å–ä»»åŠ¡ï¼Œå°è¯•æ‹‰å–ï¼Œæ¯å¤„ç†ä¸€æ¬¡ï¼ŒThread.sleep(1), ç»§ç»­ä¸‹ä¸€æ¬¡æ£€æŸ¥ã€‚ 2ã€RocketMQæ‹‰è½®è¯¢æ‹‰å–ä»»åŠ¡åˆ›å»º å› åˆæ¬¡è®¿é—®ï¼Œä¸ºé˜²æ­¢çˆ¬è™«å’Œäººæœºè¯†åˆ«ï¼Œè¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼Œå›å¤:â€˜éªŒè¯ç â€˜è·å–éªŒè¯ç æ¥è§£é”å…¨æ–‡ è§£é”å†…å®¹ org.apache.rocketmq.broker.processor.PullMessageProcessor#processRequest
é¦–å…ˆçœ‹ä¸€ä¸‹processRequestæ–¹æ³•å‚æ•°ï¼š
1private RemotingCommand processRequest( 2 final Channel channel, 3 RemotingCommand request, 4 boolean brokerAllowSuspend) Channel channelï¼šç½‘ç»œé€šé“ RemotingCommand requestï¼šæ¶ˆæ¯æ‹‰å–è¯·æ±‚ brokerAllowSuspendï¼šæ˜¯å¦å…è®¸æŒ‚èµ·ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦å…è®¸åœ¨æœªæ‰¾åˆ°æ¶ˆæ¯æ—¶æš‚æ—¶æŒ‚èµ·çº¿ç¨‹ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶é»˜è®¤ä¸ºtrueã€‚ 1case ResponseCode.PULL_NOT_FOUND: 2 if (brokerAllowSuspend &amp;&amp; hasSuspendFlag) { // @1 3 long pollingTimeMills = suspendTimeoutMillisLong; // @2 4 if (!</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/15/">é˜…è¯»æ›´å¤šå…³äºåäº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯PULL-é•¿è½®è¯¢æ¨¡å¼çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">9 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/11/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="åä¸€ã€RocketMQæºç åˆ†æåˆ·ç›˜æœºåˆ¶" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="åä¸€ã€RocketMQæºç åˆ†æåˆ·ç›˜æœºåˆ¶" href="/docs/mq/rocketmq-advanced/11/">åä¸€ã€RocketMQæºç åˆ†æåˆ·ç›˜æœºåˆ¶</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">RocketMQ åˆ·ç›˜æ”¯æŒåŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜ã€‚ä¸ºäº†äº†è§£å…¶å…·ä½“å®ç°ï¼Œæˆ‘ä»¬ä»¥ Commitlog çš„å­˜å‚¨ä¸ºä¾‹æ¥è¯´æ˜ RocketMQ æ˜¯å¦‚ä½•è¿›è¡Œç£ç›˜è¯»å†™ã€‚
Comitlog#putMessage é¦–å…ˆå°†æ¶ˆæ¯å†™å…¥åˆ° MappedFile,å†…å­˜æ˜ å°„æ–‡ä»¶ã€‚ç„¶åæ ¹æ®åˆ·ç›˜ç­–ç•¥åˆ·å†™åˆ°ç£ç›˜ï¼Œå…¥å£å¦‚ä¸‹ï¼š
CommitLog#handleDiskFlush
1public void handleDiskFlush(AppendMessageResult result, PutMessageResult putMessageResult, MessageExt messageExt) { // @1 2 // Synchronization flush 3 if (FlushDiskType.SYNC_FLUSH == this.defaultMessageStore.getMessageStoreConfig().getFlushDiskType()) { // @2 4 final GroupCommitService service = (GroupCommitService) this.flushCommitLogService; 5 if (messageExt.isWaitStoreMsgOK()) { 6 GroupCommitRequest request = new GroupCommitRequest(result.getWroteOffset() + result.getWroteBytes()); 7 service.putRequest(request); 8 boolean flushOK = request.waitForFlush(this.defaultMessageStore.getMessageStoreConfig().getSyncFlushTimeout()); 9 if (!flushOK) { 10 log.error(&#34;do groupcommit, wait for flush failed, topic: &#34; + messageExt.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/11/">é˜…è¯»æ›´å¤šå…³äºåä¸€ã€RocketMQæºç åˆ†æåˆ·ç›˜æœºåˆ¶çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">7 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/4/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="å››ã€RocketMQæºç åˆ†æä¹‹æ¶ˆæ¯æ¶ˆè´¹æ¦‚è¿°" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="å››ã€RocketMQæºç åˆ†æä¹‹æ¶ˆæ¯æ¶ˆè´¹æ¦‚è¿°" href="/docs/mq/rocketmq-advanced/4/">å››ã€RocketMQæºç åˆ†æä¹‹æ¶ˆæ¯æ¶ˆè´¹æ¦‚è¿°</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">1ã€æ¶ˆæ¯æ¶ˆè´¹æ¦‚è¿° æ¶ˆæ¯æ¶ˆè´¹æ–¹å¼
æ‹‰å–ã€æ¨é€ã€‚ æ¶ˆè´¹è€…ç»„ä¸æ¶ˆè´¹æ¨¡å¼
å¤šä¸ªæ¶ˆè´¹è€…ç»„æˆä¸€ä¸ªæ¶ˆè´¹ç»„ï¼Œä¸¤ç§æ¨¡å¼ï¼šé›†ç¾¤ï¼ˆæ¶ˆæ¯è¢«å…¶ä¸­ä»»ä½•ä¸€ä¸ªæ¶ˆæ¯è€…æ¶ˆè´¹ï¼‰ã€å¹¿æ’­æ¨¡å¼ï¼ˆå…¨éƒ¨æ¶ˆè´¹è€…æ¶ˆè´¹ï¼‰ã€‚ ConsumeFromWhere consumeFromWhere
ä»ä½•å¤„å¼€å§‹æ¶ˆè´¹ï¼Œå¯é€‰å€¼ï¼š
1ï¼‰CONSUME_FROM_LAST_OFFSETï¼šä¸Šä¸€æ¬¡æ¶ˆè´¹åç§»é‡
2ï¼‰CONSUME_FROM_FIRST_OFFSETï¼šä»å¤´å¼€å§‹
3ï¼‰CONSUME_FROM_TIMESTAMPï¼šä»æŸä¸ªæ—¶é—´ç‚¹å¼€å§‹ æ¶ˆè´¹è¿›åº¦å­˜å‚¨
å…¶å®ç°ç±»ä¸ºï¼šOffsetStore offsetStoreã€‚æ¶ˆè´¹è€…éœ€è¦è®°å½•æ¶ˆæ¯æ¶ˆè´¹çš„è¿›åº¦ï¼š
1ï¼‰å¹¿æ’­æ¨¡å¼ï¼šå¹¿æ’­æ¨¡å¼ç”±äºæ¯ä¸ªæ¶ˆè´¹è€…éƒ½éœ€è¦æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ•…æ¶ˆæ¯çš„è¿›åº¦ï¼ˆæœ€åæ¶ˆè´¹çš„åç§»é‡å¯ä»¥ä¿å­˜åœ¨æœ¬åœ°ï¼‰ã€‚
2ï¼‰é›†ç¾¤æ¨¡å¼ï¼šç”±äºé›†ç¾¤ä¸­çš„æ¶ˆè´¹è€…åªè¦ä¸€ä¸ªæ¶ˆè´¹æ¶ˆæ¯å³å¯ï¼Œæ•…æ¶ˆæ¯çš„æ¶ˆè´¹è¿›åº¦ï¼Œéœ€è¦ä¿å­˜åœ¨é›†ä¸­ç‚¹ï¼Œæ•… RocketMQå­˜å‚¨åœ¨Brokeræ‰€åœ¨çš„æœåŠ¡å™¨ã€‚ 2ã€æ¶ˆæ¯æ¶ˆè´¹å®ç° é¦–å…ˆçœ‹ä¸€ä¸‹æ¶ˆè´¹ Demoã€‚
ä½¿ç”¨æ¨é€æ¨¡å¼ï¼Œè®¾ç½®æ¶ˆè´¹è€…æ‰€å±ç»„ï¼Œè®¢é˜…ä¸»é¢˜ã€å®šä¹‰æ¶ˆæ¯æ¶ˆè´¹å›è°ƒæ¥å£ï¼Œæ¨é€æ¶ˆæ¯åæ¶ˆè´¹æ–¹å…·ä½“ä¸šåŠ¡å¤„ç†ï¼Œå¹¶è¿”å›CONSUME_SUCCESSè¡¨ç¤ºæ¶ˆè´¹æˆåŠŸã€‚
æ¶ˆæ¯æ¶ˆè´¹è€…å…·ä½“å®ç°ç±»ï¼šorg.apache.rocketmq.client.impl.consumer.DefaultMQPushConsumerImplã€‚
2.1 DefaultMQPushConsumerImpl 2.1.1 æ¶ˆè´¹ç«¯åˆå§‹åŒ–ï¼ˆæ„é€ æ–¹æ³•ï¼‰ ç„¶åå¼€å§‹é‡ç‚¹ä» star tæ–¹æ³•æ·±å…¥ç ”ç©¶ DefaultMQPushConsumerImpl çš„å†…éƒ¨æœºåˆ¶ã€‚
1public synchronized void start() throws MQClientException { 2 switch (this.serviceState) { 3 case CREATE_JUST: 4 log.info(&#34;the consumer [{}] start beginning. messageModel={}, isUnitMode={}&#34;, this.defaultMQPushConsumer.getConsumerGroup(), 5 this.defaultMQPushConsumer.getMessageModel(), this.defaultMQPushConsumer.isUnitMode()); 6 this.serviceState = ServiceState.START_FAILED; // @1 7 this.checkConfig(); //@2 8 this.copySubscription(); //@3 9 if (this.</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/4/">é˜…è¯»æ›´å¤šå…³äºå››ã€RocketMQæºç åˆ†æä¹‹æ¶ˆæ¯æ¶ˆè´¹æ¦‚è¿°çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">2 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/5/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="äº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ¶ˆè´¹æœºåˆ¶â€”-æ¶ˆè´¹è€…æ‹‰å–æ¶ˆæ¯æœºåˆ¶" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="äº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ¶ˆè´¹æœºåˆ¶â€”-æ¶ˆè´¹è€…æ‹‰å–æ¶ˆæ¯æœºåˆ¶" href="/docs/mq/rocketmq-advanced/5/">äº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ¶ˆè´¹æœºåˆ¶â€”-æ¶ˆè´¹è€…æ‹‰å–æ¶ˆæ¯æœºåˆ¶</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">1ã€ æ¶ˆæ¯æ¶ˆè´¹éœ€è¦è§£å†³çš„é—®é¢˜ï¼›
é¦–å…ˆå†æ¬¡é‡å¤å•°å—¦ä¸€ä¸‹RocketMQæ¶ˆæ¯æ¶ˆè´¹çš„ä¸€äº›åŸºæœ¬å…ƒç´ çš„å…³ç³»
ä¸»é¢˜â€”ã€‹ æ¶ˆæ¯é˜Ÿåˆ—(MessageQueue) 1 å¯¹å¤š
ä¸»é¢˜â€”-ã€‹ æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œï¼Œï¼Œä¸€èˆ¬ä¸»é¢˜ä¼šç”±å¤šä¸ªç”Ÿäº§è€…ç»„æˆï¼Œç”Ÿäº§è€…ç»„
ä¸»é¢˜â€”- ã€‹ æ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œï¼Œä¸€èˆ¬ä¸€ä¸ªä¸»é¢˜ä¹Ÿä¼šè¢«å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹
é‚£æ¶ˆæ¯æ¶ˆè´¹è‡³å°‘éœ€è¦è§£å†³å¦‚ä¸‹é—®é¢˜ï¼š
1ã€ ä¸€ä¸ªæ¶ˆè´¹ç»„ä¸­å¤šä¸ªæ¶ˆè´¹è€…æ˜¯å¦‚ä½•å¯¹æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆ1ä¸ªä¸»é¢˜å¤šä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼‰è¿›ï¼›
è¡Œè´Ÿè½½æ¶ˆè´¹çš„ã€‚
2ã€ ä¸€ä¸ªæ¶ˆè´¹è€…ä¸­å¤šä¸ªçº¿ç¨‹åˆæ˜¯å¦‚ä½•åä½œï¼ˆå¹¶å‘ï¼‰çš„æ¶ˆè´¹åˆ†é…ç»™è¯¥æ¶ˆè´¹è€…çš„ï¼›
æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å‘¢ï¼Ÿ
3ã€ æ¶ˆæ¯æ¶ˆè´¹è¿›åº¦å¦‚ä½•ä¿å­˜ï¼ŒåŒ…æ‹¬MQæ˜¯å¦‚ä½•çŸ¥é“æ¶ˆæ¯æ˜¯å¦æ­£å¸¸è¢«æ¶ˆè´¹äº†ï¼›
4ã€ RocketMQæ¨æ‹‰æ¨¡å¼å®ç°æœºåˆ¶ï¼›
å†æä¸€ä¸ªä¸šç•Œå…³äºæ¶ˆè´¹è€…ä¸æ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆè´¹è§„åˆ™
1ä¸ªæ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹å¤šä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½†ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œè¿™åˆæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ
åç»­å‡ ç¯‡æ–‡ç« éƒ½ä¼šå›´ç»•ä¸Šè¿°é—®é¢˜è¿›è¡Œå±•å¼€ï¼Œè¯»è€…æœ‹å‹ä»¬ï¼Œå¸¦ä¸Šä¸Šè¿°çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èµ·é¨æ¸¸åœ¨RocketMQæ¶ˆæ¯æ¶ˆè´¹çš„ä¸–ç•Œä¸­å§ã€‚
2ã€ æ¶ˆè´¹ç«¯æ‹‰å–æ¶ˆæ¯æœºåˆ¶ï¼›
2ã€ 1æ¶ˆæ¯æ¶ˆè´¹ç«¯æ ¸å¿ƒç±»ä»‹ç»ï¼›
DefaultMQPushConsumerImpl ï¼šæ¶ˆæ¯æ¶ˆæ¯è€…é»˜è®¤å®ç°ç±»ï¼Œåº”ç”¨ç¨‹åºä¸­ç›´æ¥ç”¨è¯¥ç±»çš„å®ä¾‹å®Œæˆæ¶ˆæ¯çš„æ¶ˆè´¹ï¼Œå¹¶å›è°ƒä¸šåŠ¡æ–¹æ³•ã€‚
RebalanceImpl å­—é¢ä¸Šçš„æ„æ€ï¼ˆé‡æ–°å¹³è¡¡ï¼‰ä¹Ÿå°±æ˜¯æ¶ˆè´¹ç«¯æ¶ˆè´¹è€…ä¸æ¶ˆæ¯é˜Ÿåˆ—çš„é‡æ–°åˆ†å¸ƒï¼Œä¸æ¶ˆæ¯åº”è¯¥åˆ†é…ç»™å“ªä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹æ¯æ¯ç›¸å…³ã€‚
MQClientInstance æ¶ˆæ¯å®¢æˆ·ç«¯å®ä¾‹ï¼Œè´Ÿè½½ä¸MQæœåŠ¡å™¨ï¼ˆBroker,Nameserver)äº¤äº’çš„ç½‘ç»œå®ç°
PullAPIWrapper pullä¸Pushåœ¨RocketMQä¸­ï¼Œå…¶å®å°±åªæœ‰Pullæ¨¡å¼ï¼Œæ‰€ä»¥Pushå…¶å®å°±æ˜¯ç”¨pullå°è£…ä¸€ä¸‹
MessageListenerInner æ¶ˆè´¹æ¶ˆè´¹å›è°ƒç±»ï¼Œå½“æ¶ˆæ¯åˆ†é…ç»™æ¶ˆè´¹è€…æ¶ˆè´¹æ—¶ï¼Œæ‰§è¡Œçš„ä¸šåŠ¡ä»£ç å…¥å£
OffsetStore æ¶ˆæ¯æ¶ˆè´¹è¿›åº¦ä¿å­˜
ConsumeMessageService æ¶ˆæ¯æ¶ˆè´¹é€»è¾‘
æ¶ˆè´¹ç«¯ä½¿ç”¨å®ä¾‹ï¼š
2ã€ 2æ¶ˆæ¯æ¶ˆè´¹è€…å¯åŠ¨å…³é”®æµç¨‹ï¼›
1ï¼‰æ„å»º RebalanceImpl
2ï¼‰PullAPIWrapper å¯¹è±¡æ„å»º
3ï¼‰æ¶ˆè´¹è¿›åº¦åŠ è½½
4ï¼‰æ¶ˆè´¹ç®¡ç†ConsumeMessageService
5ï¼‰MQClientInstance å¯åŠ¨ï¼Œè¿›å…¥æ¶ˆæ¯æ¶ˆè´¹
2ã€ 2ã€1MQClientInstanceï¼›
2ã€ 2ã€1.1å®šæ—¶ä»»åŠ¡ä¸€è§ˆè¡¨ï¼›
æ¯éš”2åˆ†é’Ÿå°è¯•è·å–ä¸€æ¬¡NameServeråœ°å€
æ¯éš”30Så°è¯•æ›´æ–°ä¸»é¢˜è·¯ç”±ä¿¡æ¯
æ¯éš”30S è¿›è¡ŒBrokerå¿ƒè·³æ£€æµ‹
é»˜è®¤æ¯éš”5ç§’æŒä¹…åŒ–ConsumeOffset
é»˜è®¤æ¯éš”1Sæ£€æŸ¥çº¿ç¨‹æ± é€‚é…
ä¸Šè¿°å®šæ—¶ä»»åŠ¡ï¼Œä¸‹æ–‡æˆ–åç»­æ–‡ç« ä¼šé‡ç‚¹å‰–æä¸€ä¸‹ã€æŒä¹…åŒ–ConsumeOffsetã€‘
2ã€ 2ã€1.2PullMesssageServiceï¼›
ä»ä¸Šé¢æ„Ÿæ‚Ÿï¼šä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œä¸€ä¸ªæ¶ˆè´¹ç»„ï¼Œåªéœ€è¦ä¸€ä¸ªDefaultMQPushConsumerImpl,ï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œä½¿ç”¨å¤šçº¿ç¨‹åˆ›å»ºå¤šä¸ª</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/5/">é˜…è¯»æ›´å¤šå…³äºäº”ã€RocketMQæºç åˆ†ææ¶ˆæ¯æ¶ˆè´¹æœºåˆ¶â€”-æ¶ˆè´¹è€…æ‹‰å–æ¶ˆæ¯æœºåˆ¶çš„å†…å®¹ã€‚</a></div></div></div></div><div class="mb-3 mb-lg-4"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 hb-module mb-0"><div class="hb-blog-post-meta d-flex align-items-center"><a class="hb-blog-post-author-link text-decoration-none" href="/authors/andywu/" title="å®‰å›¾æ–°"><picture><img class="hb-blog-author-img rounded-circle" src="https://cdn.hotmindshare.com/public%2Fandyng_1000x1000.png" alt="å®‰å›¾æ–°" loading="lazy"/>
</picture></a><span class="hb-blog-post-date">2023å¹´10æœˆ21æ—¥</span>
<span class="hb-blog-post-reading-time">4 åˆ†é’Ÿé˜…è¯»</span>
<span class="hb-blog-post-section"><a class="badge bg-secondary text-decoration-none fw-normal" href="/docs/">æŠ€æœ¯æ•™ç¨‹</a></span></div><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/mq/rocketmq-advanced/1/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="ä¸€ã€RocketMQæºç åˆ†æä¹‹NameServer" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="ä¸€ã€RocketMQæºç åˆ†æä¹‹NameServer" href="/docs/mq/rocketmq-advanced/1/">ä¸€ã€RocketMQæºç åˆ†æä¹‹NameServer</a></div><div class="hb-blog-post-meta d-block text-nowrap text-truncate mb-2"><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">æ¶ˆæ¯é˜Ÿåˆ—</a>
</span><span class="hb-blog-post-taxonomy-meta"><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href="/series/rocketmq/">RocketMQ</a></span></div><div class="hb-blog-post-summary card-text text-secondary mb-auto">1ã€RocketMQç»„ä»¶æ¦‚è¿° NameServer
NameServerç›¸å½“äºé…ç½®ä¸­å¿ƒï¼Œç»´æŠ¤Brokeré›†ç¾¤ã€Brokerä¿¡æ¯ã€Brokerå­˜æ´»ä¿¡æ¯ã€ä¸»é¢˜ä¸é˜Ÿåˆ—ä¿¡æ¯ç­‰ã€‚NameServerå½¼æ­¤ä¹‹é—´ä¸é€šä¿¡ï¼Œæ¯ä¸ªBrokerä¸é›†ç¾¤å†…æ‰€æœ‰çš„Nameserverä¿æŒé•¿è¿æ¥ã€‚ 2ã€æºç åˆ†æNameServer æœ¬æ–‡ä¸å¯¹ NameServer ä¸ Brokerã€Producer é›†ç¾¤ã€Consumer é›†ç¾¤çš„ç½‘ç»œé€šä¿¡åšè¯¦ç»†è§£è¯»ï¼ˆè¯¥ç³»åˆ—åç»­ä¸“é—¨è¿›è¡Œè®²è§£ï¼‰
æœ¬æ–‡é‡ç‚¹å…³æ³¨ NameServer ä½œä¸º MQ é›†ç¾¤çš„é…ç½®ä¸­å¿ƒå­˜å‚¨ä»€ä¹ˆä¿¡æ¯ã€‚
2.1 æºç åˆ†æNamesrvController NameserController æ˜¯ NameServer æ¨¡å—çš„æ ¸å¿ƒæ§åˆ¶ç±»ã€‚
2.1.1 NamesrvConfig NamesrvConfig,ä¸»è¦æŒ‡å®š nameserver çš„ç›¸å…³é…ç½®å±æ€§ï¼š
kvConfigPath(kvConfig.json)ã€‚ mqhome/namesrv/namesrv.propertiesã€‚ orderMessageEnableï¼Œæ˜¯å¦å¼€å¯é¡ºåºæ¶ˆæ¯åŠŸèƒ½ï¼Œé»˜è®¤ä¸ºfalseã€‚ 2.1.2 ScheduledExecutorService 1privateÂ finalÂ ScheduledExecutorServiceÂ scheduledExecutorServiceÂ =Â Executors. NameServer å®šæ—¶ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹æ± ï¼Œé»˜è®¤å®šæ—¶æ‰§è¡Œä¸¤ä¸ªä»»åŠ¡ï¼š
ä»»åŠ¡1ã€æ¯éš” 10s æ‰«æ broker ,ç»´æŠ¤å½“å‰å­˜æ´»çš„Brokerä¿¡æ¯ã€‚ ä»»åŠ¡2ã€æ¯éš” 10s æ‰“å°KVConfig ä¿¡æ¯ã€‚ 2.1.3 KVConfigManager è¯»å–æˆ–å˜æ›´NameServerçš„é…ç½®å±æ€§ï¼ŒåŠ è½½ NamesrvConfig ä¸­é…ç½®çš„é…ç½®æ–‡ä»¶åˆ°å†…å­˜ï¼Œæ­¤ç±»ä¸€ä¸ªäº®ç‚¹å°±æ˜¯ä½¿ç”¨è½»é‡çº§çš„éçº¿ç¨‹å®‰å…¨å®¹å™¨ï¼Œå†ç»“åˆè¯»å†™é”å¯¹èµ„æºè¯»å†™è¿›è¡Œä¿æŠ¤ã€‚å°½æœ€å¤§ç¨‹åº¦æé«˜çº¿ç¨‹çš„å¹¶å‘åº¦ã€‚
2.1.4 RouteInfoManager NameServer æ•°æ®çš„è½½ä½“ï¼Œè®°å½• Brokerã€Topic ç­‰ä¿¡æ¯ã€‚
1 private final static long BROKER_CHANNEL_EXPIRED_TIME = 1000 * 60 * 2; //@1 2 private final ReadWriteLock lock = new ReentrantReadWriteLock(); //@2 3 private final HashMap&lt;String/* topic */, List&lt;QueueData&gt;&gt; topicQueueTable; //@3 4 private final HashMap&lt;String/* brokerName */, BrokerData&gt; brokerAddrTable; //@4 5 private final HashMap&lt;String/* clusterName */, Set&lt;String/* brokerName */&gt;&gt; clusterAddrTable; //@5 6 private final HashMap&lt;String/* brokerAddr */, BrokerLiveInfo&gt; brokerLiveTable; //@6 ä»£ç @1ï¼ŒNameServer ä¸ Broker ç©ºé—²æ—¶é•¿ï¼Œé»˜è®¤2åˆ†é’Ÿï¼Œåœ¨2åˆ†é’Ÿå†… Nameserver æ²¡æœ‰æ”¶åˆ° Broker çš„å¿ƒè·³åŒ…ï¼Œåˆ™å…³é—­è¯¥è¿æ¥ã€‚</div><div class="mt-2"><a class="text-secondary" href="/docs/mq/rocketmq-advanced/1/">é˜…è¯»æ›´å¤šå…³äºä¸€ã€RocketMQæºç åˆ†æä¹‹NameServerçš„å†…å®¹ã€‚</a></div></div></div></div></div><nav class="hb-blog-pagination mb-3" aria-label="Page navigation"><ul class="pagination flex-wrap justify-content-center"><li class="page-item"><a class="page-link" href="/series/rocketmq/page/2/" aria-label="å‰ä¸€é¡µ"><span aria-hidden="true">Â«</span></a></li><li class="page-item"><a class="page-link" href="/series/rocketmq/">1</a></li><li class="page-item"><a class="page-link" href="/series/rocketmq/page/2/">2</a></li><li class="page-item active"><a class="page-link" href="/series/rocketmq/page/3/">3</a></li><li class="page-item disabled"><a class="page-link" href="" aria-label="ä¸‹ä¸€é¡µ"><span aria-hidden="true">Â»</span></a></li></ul></nav></div><div class="hb-blog-sidebar pe-lg-1"><div class="hb-blog-sidebar-profile hb-module d-flex flex-column justify-content-center align-items-center"><picture><source srcset="/images/logo_hu3f5eb531558986e612421c7146e04118_941594_c6864c8867b5b1d8c1d896794c52a337.webp" type="image/webp"/><img class="hb-blog-sidebar-profile-img rounded-circle img-fluid mb-3" src="https://www.hotmindshare.com/images/logo_hu3f5eb531558986e612421c7146e04118_941594_100x0_resize_box_3.b5418e6eba234f774b07e8ca647386b9.png" alt="" loading="lazy" height="100" width="100"/></picture><p class="hb-blog-sidebar-profile-title text-center h5 mb-2">ç¨‹åºå‘˜å®‰ä»”</p><p class="hb-blog-sidebar-profile-desc text-center mb-2">ä¸€ä¸ªåªçˆ±æŠ˜è…¾æŠ€æœ¯çš„æ™®é€šäºº</p><p class="hb-blog-sidebar-profile-meta mb-0"></p><div class="hb-footer-socials d-flex mb-0 mt-1 justify-content-center"><a class="hb-social p-2" href="mailto:andywuwu0728@gmail.com" target="_blank" rel="nofollow me" title="Email"><svg aria-hidden="true" class="bi bi-envelope-fillbi bi-envelope-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"></path></svg></a><a class="hb-social p-2" href="https://github.com/Andywugh" target="_blank" rel="nofollow me" title="GitHub"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:%!s(bool=true)" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="hb-social p-2" href="/index.xml" target="_blank" rel="nofollow me" title="RSS"><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"></path></svg></a><a class="hb-social p-2" href="https://www.zhihu.com/people/Andywuwu" target="_blank" rel="nofollow me" title="çŸ¥ä¹"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:#056de8" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>Zhihu</title><path d="M5.721.0C2.251.0.0 2.25.0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75.0 18.281.0zm1.964 4.078c-.271.73-.5 1.434-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58.104 58.104.0 01-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.223 9.223.0 01-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125zM13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"></path></svg></a></div></div><div style="padding-bottom:1px"><nav style="margin-bottom:1px;display:flex;flex-direction:column"><div style="float:left;text-align:center!important"><img style="width:110apx;height:110px" src="https://cdn.hotmindshare.com/public%2Fmy_QR_Code.jpg" alt="å…³æ³¨æˆ‘ä»¬" title="å…³æ³¨å…¬ä¼—å·"/></div><p style="font-size:11px;float:left;margin-top:8px;text-align:center!important"><span style="line-height:1.8"><span style="rgb(161,182,226)89color:); font-size: 15px; letter-spacing: 3px; line-height: 0">å…³æ³¨å¾®ä¿¡å…¬ä¼—å·</span><br/><span style="rgb(161,182,226)89color:); font-weight: 300; line-height: 1; font-size: 14px"><b>è·å–æ›´å¤šæŠ€æœ¯å¹²è´§å’Œèµ„æ–™</b><br/></span><br/></span></p></nav></div><div class="hb-blog-sidebar-posts hb-module"><ul class="nav nav-pills nav-fill" role="tablist"><li class="nav-item" role="presentation"><button class="nav-link active" id="recent-posts-tab" data-bs-toggle="tab" data-bs-target="#recent-posts" type="button" role="tab" aria-controls="recent-posts" aria-selected="true">
æœ€è¿‘æ–‡ç« </button></li></ul><div class="tab-content mt-2"><div class="tab-pane slide active" id="recent-posts" role="tabpanel" aria-labelledby="recent-posts-tab" tabindex="0"><div class="slide"><div class="slide-inner row row-cols-1"><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/blog/2023/12/20231229_10_reasons_to_learn_spring_boot_in_2024/"><picture><source srcset="/images/covers/20231229_10_reasons_to_learn_spring_boot_in_2024_huadb82ac6e42be1033d2bfdc1b1e34746_29915_900x500_resize_q75_h2_box_3.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/covers/20231229_10_reasons_to_learn_spring_boot_in_2024.46b0435dee9d577bf67bac590b07aa73.png" alt="2024å¹´10ä¸ªå€¼å¾—ç»§ç»­å­¦ä¹ Sprint Bootçš„ç†ç”±" loading="lazy" height="500" width="900"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="2024å¹´10ä¸ªå€¼å¾—ç»§ç»­å­¦ä¹ Sprint Bootçš„ç†ç”±" href="/blog/2023/12/20231229_10_reasons_to_learn_spring_boot_in_2024/"><span class="text-danger"><svg aria-hidden="true" class="bi bi-pinbi bi-pin hi-svg-inline me-1" fill="currentcolor" height=".85em" viewBox="0 0 16 16" width=".85em" xmlns="http://www.w3.org/2000/svg"><path d="M4.146.146A.5.5.0 014.5.0h7a.5.5.0 01.5.5c0 .68-.342 1.174-.646 1.479-.126.125-.25.224-.354.298v4.431l.078.048c.203.127.476.314.751.555C12.36 7.775 13 8.527 13 9.5a.5.5.0 01-.5.5h-4v4.5c0 .276-.224 1.5-.5 1.5s-.5-1.224-.5-1.5V10h-4A.5.5.0 013 9.5c0-.973.64-1.725 1.17-2.189A5.921 5.921.0 015 6.708V2.277a2.77 2.77.0 01-.354-.298C4.342 1.674 4 1.179 4 .5a.5.5.0 01.146-.354zm1.58 1.408-.002-.001.002.001m-.002-.001.002.001A.5.5.0 016 2v5a.5.5.0 01-.276.447h-.002l-.012.007-.054.03a4.922 4.922.0 00-.827.58c-.318.278-.585.596-.725.936h7.792c-.14-.34-.407-.658-.725-.936a4.915 4.915.0 00-.881-.61l-.012-.006h-.002A.5.5.0 0110 7V2a.5.5.0 01.295-.458 1.775 1.775.0 00.351-.271c.08-.08.155-.17.214-.271H5.14c.06.1.133.191.214.271a1.78 1.78.0 00.37.282"></path></svg></span>2024å¹´10ä¸ªå€¼å¾—ç»§ç»­å­¦ä¹ Sprint Bootçš„ç†ç”±</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/java/concurrency_guide/9/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="9.ç®¡ç¨‹ï¼šå¹¶å‘ç¼–ç¨‹çš„ä¸‡èƒ½é’¥åŒ™" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="9.ç®¡ç¨‹ï¼šå¹¶å‘ç¼–ç¨‹çš„ä¸‡èƒ½é’¥åŒ™" href="/docs/java/concurrency_guide/9/">9.ç®¡ç¨‹ï¼šå¹¶å‘ç¼–ç¨‹çš„ä¸‡èƒ½é’¥åŒ™</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/java/concurrency_guide/8/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="8.å®‰å…¨æ€§ã€æ´»è·ƒæ€§ä»¥åŠæ€§èƒ½é—®é¢˜" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="8.å®‰å…¨æ€§ã€æ´»è·ƒæ€§ä»¥åŠæ€§èƒ½é—®é¢˜" href="/docs/java/concurrency_guide/8/">8.å®‰å…¨æ€§ã€æ´»è·ƒæ€§ä»¥åŠæ€§èƒ½é—®é¢˜</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/java/concurrency_guide/7/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="7.ç”¨&#39;ç­‰å¾…-é€šçŸ¥&#39;æœºåˆ¶ä¼˜åŒ–å¾ªç¯ç­‰å¾…" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="7.ç”¨&#39;ç­‰å¾…-é€šçŸ¥&#39;æœºåˆ¶ä¼˜åŒ–å¾ªç¯ç­‰å¾…" href="/docs/java/concurrency_guide/7/">7.ç”¨&#39;ç­‰å¾…-é€šçŸ¥&#39;æœºåˆ¶ä¼˜åŒ–å¾ªç¯ç­‰å¾…</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href="/docs/java/concurrency_guide/6/"><picture><source srcset="/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_db4ab978a5e64c694fdda20c4098bfd2.webp" type="image/webp"/><img class="hb-blog-post-card-img" src="https://www.hotmindshare.com/images/thumbnail_hu2c04c355e02fd9f63b765bcdb503cf1c_2284289_0x360_resize_box_3.c4a823371e7699a6d0a45f2ed38908a1.png" alt="6.ä¸€ä¸å°å¿ƒå°±æ­»é”äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ" loading="lazy" height="360" width="630"/></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="6.ä¸€ä¸å°å¿ƒå°±æ­»é”äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ" href="/docs/java/concurrency_guide/6/">6.ä¸€ä¸å°å¿ƒå°±æ­»é”äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ</a></div></div></div></div></div><button class="slide-control-left">
<svg aria-hidden="true" class="bi bi-arrow-left-circlebi bi-arrow-left-circle hi-svg-inline slide-control-left-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0m-4.5-.5a.5.5.0 010 1H5.707l2.147 2.146a.5.5.0 01-.708.708l-3-3a.5.5.0 010-.708l3-3a.5.5.0 11.708.708L5.707 7.5z"></path></svg><span class="visually-hidden">å‘å·¦</span>
</button>
<button class="slide-control-right">
<svg aria-hidden="true" class="bi bi-arrow-right-circlebi bi-arrow-right-circle hi-svg-inline slide-control-right-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0M4.5 7.5a.5.5.0 000 1h5.793l-2.147 2.146a.5.5.0 00.708.708l3-3a.5.5.0 000-.708l-3-3a.5.5.0 10-.708.708L10.293 7.5z"></path></svg><span class="visually-hidden">å‘å³</span></button></div></div></div></div><div class="hb-blog-sidebar-taxonomies hb-module"><ul class="nav nav-pills nav-justified mb-2" role="tablist"><li class="nav-item" role="presentation"><button class="nav-link active" id="taxonomy-authors-tab" data-bs-toggle="tab" data-bs-target="#taxonomy-authors-tab-pane" type="button" role="tab" aria-controls="taxonomy-authors-tab-pane" aria-selected="true">ä½œè€…</button></li><li class="nav-item" role="presentation"><button class="nav-link" id="taxonomy-categories-tab" data-bs-toggle="tab" data-bs-target="#taxonomy-categories-tab-pane" type="button" role="tab" aria-controls="taxonomy-categories-tab-pane" aria-selected="false">åˆ†ç±»</button></li><li class="nav-item" role="presentation"><button class="nav-link" id="taxonomy-series-tab" data-bs-toggle="tab" data-bs-target="#taxonomy-series-tab-pane" type="button" role="tab" aria-controls="taxonomy-series-tab-pane" aria-selected="false">ä¸“æ </button></li><li class="nav-item" role="presentation"><button class="nav-link" id="taxonomy-tags-tab" data-bs-toggle="tab" data-bs-target="#taxonomy-tags-tab-pane" type="button" role="tab" aria-controls="taxonomy-tags-tab-pane" aria-selected="false">æ ‡ç­¾</button></li></ul><div class="tab-content"><div class="tab-pane fade show active" id="taxonomy-authors-tab-pane" role="tabpanel" aria-labelledby="taxonomy-authors-tab" tabindex="0"><a class="taxonomy-term taxonomy-term-authors btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/authors/andywu/"><span class="taxonomy-term-title">å®‰å›¾æ–°</span>
<small class="taxonomy-term-count border rounded px-1">1184</small></a></div><div class="tab-pane fade" id="taxonomy-categories-tab-pane" role="tabpanel" aria-labelledby="taxonomy-categories-tab" tabindex="0"><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/hbase/"><span class="taxonomy-term-title">HBase</span>
<small class="taxonomy-term-count border rounded px-1">195</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/java/"><span class="taxonomy-term-title">Java</span>
<small class="taxonomy-term-count border rounded px-1">155</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="taxonomy-term-title">æ•°æ®åº“</span>
<small class="taxonomy-term-count border rounded px-1">126</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/"><span class="taxonomy-term-title">äº‘åŸç”Ÿ</span>
<small class="taxonomy-term-count border rounded px-1">94</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="taxonomy-term-title">å…³ç³»å‹æ•°æ®åº“</span>
<small class="taxonomy-term-count border rounded px-1">76</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/jfinal/"><span class="taxonomy-term-title">JFinal</span>
<small class="taxonomy-term-count border rounded px-1">70</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/devops/"><span class="taxonomy-term-title">DevOps</span>
<small class="taxonomy-term-count border rounded px-1">64</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/%E8%BF%90%E7%BB%B4/"><span class="taxonomy-term-title">è¿ç»´</span>
<small class="taxonomy-term-count border rounded px-1">64</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"><span class="taxonomy-term-title">æ¶ˆæ¯é˜Ÿåˆ—</span>
<small class="taxonomy-term-count border rounded px-1">61</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/categories/gradle/"><span class="taxonomy-term-title">Gradle</span>
<small class="taxonomy-term-count border rounded px-1">56</small></a></div><div class="tab-pane fade" id="taxonomy-series-tab-pane" role="tabpanel" aria-labelledby="taxonomy-series-tab" tabindex="0"><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/java%E7%89%B9%E4%BE%9B/"><span class="taxonomy-term-title">Javaç‰¹ä¾›</span>
<small class="taxonomy-term-count border rounded px-1">290</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/hbase/"><span class="taxonomy-term-title">HBase</span>
<small class="taxonomy-term-count border rounded px-1">195</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><span class="taxonomy-term-title">å¤§æ•°æ®</span>
<small class="taxonomy-term-count border rounded px-1">195</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/"><span class="taxonomy-term-title">åŸºç¡€æ•™ç¨‹</span>
<small class="taxonomy-term-count border rounded px-1">143</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/jfinal/"><span class="taxonomy-term-title">JFinal</span>
<small class="taxonomy-term-count border rounded px-1">70</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B/"><span class="taxonomy-term-title">è¿›é˜¶æ•™ç¨‹</span>
<small class="taxonomy-term-count border rounded px-1">57</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/gradle/"><span class="taxonomy-term-title">Gradle</span>
<small class="taxonomy-term-count border rounded px-1">56</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/mongodb/"><span class="taxonomy-term-title">MongoDB</span>
<small class="taxonomy-term-count border rounded px-1">50</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"><span class="taxonomy-term-title">ç¼–ç¨‹è¯­è¨€</span>
<small class="taxonomy-term-count border rounded px-1">46</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/series/scala/"><span class="taxonomy-term-title">Scala</span>
<small class="taxonomy-term-count border rounded px-1">43</small></a></div><div class="tab-pane fade" id="taxonomy-tags-tab-pane" role="tabpanel" aria-labelledby="taxonomy-tags-tab" tabindex="0"><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/java/"><span class="taxonomy-term-title">Java</span>
<small class="taxonomy-term-count border rounded px-1">35</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/"><span class="taxonomy-term-title">é¢è¯•é¢˜</span>
<small class="taxonomy-term-count border rounded px-1">33</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="taxonomy-term-title">å¹¶å‘ç¼–ç¨‹</span>
<small class="taxonomy-term-count border rounded px-1">20</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/git/"><span class="taxonomy-term-title">Git</span>
<small class="taxonomy-term-count border rounded px-1">2</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/jvm/"><span class="taxonomy-term-title">JVM</span>
<small class="taxonomy-term-count border rounded px-1">2</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/ai/"><span class="taxonomy-term-title">AI</span>
<small class="taxonomy-term-count border rounded px-1">1</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/dubbo/"><span class="taxonomy-term-title">Dubbo</span>
<small class="taxonomy-term-count border rounded px-1">1</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/elasticsearch/"><span class="taxonomy-term-title">ElasticSearch</span>
<small class="taxonomy-term-count border rounded px-1">1</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/hadoop/"><span class="taxonomy-term-title">Hadoop</span>
<small class="taxonomy-term-count border rounded px-1">1</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href="/tags/intellij-idea/"><span class="taxonomy-term-title">IntelliJ IDEA</span>
<small class="taxonomy-term-count border rounded px-1">1</small></a></div></div></div></div></div></div><footer class="hb-footer pt-4 pt-md-5 pb-2 pb-md-3 bg-body-tertiary"><div class="container-fluid container-lg px-4 px-md-3"><div class="row"><div class="hb-footer-site-info col mb-2 text-center"><div class="h5">ç¨‹åºå‘˜å®‰ä»”</div><ul class="list-unstyled small mb-2"><li class="mt-2">ä¸€ä¸ªåªçˆ±æŠ˜è…¾æŠ€æœ¯çš„æ™®é€šäºº</li><li class="mt-2">ç²¤ICPå¤‡2023148789å·</li></ul><div class="hb-footer-socials d-flex mb-2 justify-content-center flex-wrap"><a class="hb-social p-2" href="mailto:andywuwu0728@gmail.com" target="_blank" rel="nofollow me" title="Email"><svg aria-hidden="true" class="bi bi-envelope-fillbi bi-envelope-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"></path></svg></a><a class="hb-social p-2" href="https://github.com/Andywugh" target="_blank" rel="nofollow me" title="GitHub"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:%!s(bool=true)" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="hb-social p-2" href="/index.xml" target="_blank" rel="nofollow me" title="RSS"><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"></path></svg></a><a class="hb-social p-2" href="https://www.zhihu.com/people/Andywuwu" target="_blank" rel="nofollow me" title="çŸ¥ä¹"><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:#056de8" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>Zhihu</title><path d="M5.721.0C2.251.0.0 2.25.0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75.0 18.281.0zm1.964 4.078c-.271.73-.5 1.434-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58.104 58.104.0 01-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.223 9.223.0 01-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125zM13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"></path></svg></a></div></div></div></div></footer><script src="/js/hb.19ff2dd5085ae395c8501e5aef2fbcc49e7612473405d8eb7352b40a406e9daf.js" integrity="sha256-Gf8t1Qha45XIUB5a7y+8xJ52Ekc0Bdjrc1K0CkBuna8=" defer=""></script><script src="/js/search.60c6325701a1a087903f75b2304b1bb0ff0572506d58f09d2f9ce6c41cc85908.js" defer=""></script><script>"serviceWorker"in navigator&&window.addEventListener("DOMContentLoaded",function(){navigator.serviceWorker.register("/sw.js")})</script></body></html>